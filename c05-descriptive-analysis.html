<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Descriptive analyses in srvyr | Tidy Survey Book</title>
  <meta name="description" content="Bookdown for upcoming book on survey analysis the tidy way." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Descriptive analyses in srvyr | Tidy Survey Book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Bookdown for upcoming book on survey analysis the tidy way." />
  <meta name="github-repo" content="tidy-survey-r/tidy-survey-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Descriptive analyses in srvyr | Tidy Survey Book" />
  
  <meta name="twitter:description" content="Bookdown for upcoming book on survey analysis the tidy way." />
  

<meta name="author" content="Stephanie Zimmer, Rebecca J. Powell, and Isabella Velásquez" />


<meta name="date" content="2023-08-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="c04-understanding-survey-data-documentation.html"/>
<link rel="next" href="c06-statistical-testing.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="c01-intro.html"><a href="c01-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="c01-intro.html"><a href="c01-intro.html#what-to-expect"><i class="fa fa-check"></i><b>1.1</b> What to expect</a></li>
<li class="chapter" data-level="1.2" data-path="c01-intro.html"><a href="c01-intro.html#book-datasets"><i class="fa fa-check"></i><b>1.2</b> Datasets used in this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html"><i class="fa fa-check"></i><b>2</b> Overview of Surveys</a>
<ul>
<li class="chapter" data-level="2.1" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#pre-survey-planning"><i class="fa fa-check"></i><b>2.2</b> Pre-Survey Planning</a></li>
<li class="chapter" data-level="2.3" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-design"><i class="fa fa-check"></i><b>2.3</b> Study Design</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-design-sampdesign"><i class="fa fa-check"></i><b>2.3.1</b> Sampling Design</a></li>
<li class="chapter" data-level="2.3.2" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-design-dcplanning"><i class="fa fa-check"></i><b>2.3.2</b> Data Collection Planning</a></li>
<li class="chapter" data-level="2.3.3" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-design-questionnaire"><i class="fa fa-check"></i><b>2.3.3</b> Questionnaire Design</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-datacollection"><i class="fa fa-check"></i><b>2.4</b> Data Collection</a></li>
<li class="chapter" data-level="2.5" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-post"><i class="fa fa-check"></i><b>2.5</b> Post-Survey Processing</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-post-cleaning"><i class="fa fa-check"></i><b>2.5.1</b> Data Cleaning and Imputation</a></li>
<li class="chapter" data-level="2.5.2" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-post-weighting"><i class="fa fa-check"></i><b>2.5.2</b> Weighting</a></li>
<li class="chapter" data-level="2.5.3" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-post-disclosure"><i class="fa fa-check"></i><b>2.5.3</b> Disclosure</a></li>
<li class="chapter" data-level="2.5.4" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#overview-post-documentation"><i class="fa fa-check"></i><b>2.5.4</b> Documentation</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="c02-overview-surveys.html"><a href="c02-overview-surveys.html#post-survey-data-analysis-and-reporting"><i class="fa fa-check"></i><b>2.6</b> Post-survey data analysis and reporting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html"><i class="fa fa-check"></i><b>3</b> Specifying sample designs and replicate weights in {srvyr}</a>
<ul>
<li class="chapter" data-level="" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#prereq3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="3.1" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#common-sampling-designs"><i class="fa fa-check"></i><b>3.2</b> Common sampling designs</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#simple-random-sample-without-replacement"><i class="fa fa-check"></i><b>3.2.1</b> Simple random sample without replacement</a></li>
<li class="chapter" data-level="3.2.2" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#simple-random-sample-with-replacement"><i class="fa fa-check"></i><b>3.2.2</b> Simple random sample with replacement</a></li>
<li class="chapter" data-level="3.2.3" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#stratified-sampling"><i class="fa fa-check"></i><b>3.2.3</b> Stratified sampling</a></li>
<li class="chapter" data-level="3.2.4" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#clustered-sampling"><i class="fa fa-check"></i><b>3.2.4</b> Clustered sampling</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#replicate-weights"><i class="fa fa-check"></i><b>3.3</b> Replicate weights</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#balanced-repeated-replication-brr-method"><i class="fa fa-check"></i><b>3.3.1</b> Balanced Repeated Replication (BRR) Method</a></li>
<li class="chapter" data-level="3.3.2" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#fays-brr-method"><i class="fa fa-check"></i><b>3.3.2</b> Fay’s BRR Method</a></li>
<li class="chapter" data-level="3.3.3" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#jackknife-method"><i class="fa fa-check"></i><b>3.3.3</b> Jackknife method</a></li>
<li class="chapter" data-level="3.3.4" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#bootstrap-method"><i class="fa fa-check"></i><b>3.3.4</b> Bootstrap Method</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#und-surv-doc"><i class="fa fa-check"></i><b>3.4</b> Understanding survey design documentation</a></li>
<li class="chapter" data-level="3.5" data-path="c03-specifying-sample-designs.html"><a href="c03-specifying-sample-designs.html#exercises"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html"><i class="fa fa-check"></i><b>4</b> Understanding Survey Data Documentation</a>
<ul>
<li class="chapter" data-level="" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#prereq4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#types-of-survey-documentation"><i class="fa fa-check"></i><b>4.2</b> Types of Survey Documentation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#technical-documentation"><i class="fa fa-check"></i><b>4.2.1</b> Technical Documentation</a></li>
<li class="chapter" data-level="4.2.2" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#questionnaires"><i class="fa fa-check"></i><b>4.2.2</b> Questionnaires</a></li>
<li class="chapter" data-level="4.2.3" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#codebooks"><i class="fa fa-check"></i><b>4.2.3</b> Codebooks</a></li>
<li class="chapter" data-level="4.2.4" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#errata"><i class="fa fa-check"></i><b>4.2.4</b> Errata</a></li>
<li class="chapter" data-level="4.2.5" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#additional-resources"><i class="fa fa-check"></i><b>4.2.5</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#working-with-missing-data"><i class="fa fa-check"></i><b>4.3</b> Working with Missing Data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#accounting-for-questionnaire-skip-patterns"><i class="fa fa-check"></i><b>4.3.1</b> Accounting for Questionnaire Skip Patterns</a></li>
<li class="chapter" data-level="4.3.2" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#accounting-for-unintentional-missing-data"><i class="fa fa-check"></i><b>4.3.2</b> Accounting for Unintentional Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#example-american-national-election-studies-anes-2020-survey-documentation"><i class="fa fa-check"></i><b>4.4</b> Example: American National Election Studies (ANES) 2020 Survey Documentation</a></li>
<li class="chapter" data-level="4.5" data-path="c04-understanding-survey-data-documentation.html"><a href="c04-understanding-survey-data-documentation.html#searching-for-public-use-survey-data"><i class="fa fa-check"></i><b>4.5</b> Searching for Public-Use Survey Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html"><i class="fa fa-check"></i><b>5</b> Descriptive analyses in srvyr</a>
<ul>
<li class="chapter" data-level="" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#prereq5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="5.1" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#similarities-between-dplyr-and-srvyr-functions"><i class="fa fa-check"></i><b>5.2</b> Similarities between {dplyr} and {srvyr} functions</a></li>
<li class="chapter" data-level="5.3" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#deciding-on-descriptive-analyses"><i class="fa fa-check"></i><b>5.3</b> Deciding on descriptive analyses</a></li>
<li class="chapter" data-level="5.4" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#measures-of-distribution"><i class="fa fa-check"></i><b>5.4</b> Measures of distribution</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#counts-and-cross-tabulations"><i class="fa fa-check"></i><b>5.4.1</b> Counts and cross-tabulations</a></li>
<li class="chapter" data-level="5.4.2" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#totals-and-sums"><i class="fa fa-check"></i><b>5.4.2</b> Totals and sums</a></li>
<li class="chapter" data-level="5.4.3" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#proportions"><i class="fa fa-check"></i><b>5.4.3</b> Proportions</a></li>
<li class="chapter" data-level="5.4.4" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#quantiles"><i class="fa fa-check"></i><b>5.4.4</b> Quantiles</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>5.5</b> Measures of central tendency</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#means"><i class="fa fa-check"></i><b>5.5.1</b> Means</a></li>
<li class="chapter" data-level="5.5.2" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#medians"><i class="fa fa-check"></i><b>5.5.2</b> Medians</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#measures-of-dispersion"><i class="fa fa-check"></i><b>5.6</b> Measures of dispersion</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#standard-deviation-and-variance"><i class="fa fa-check"></i><b>5.6.1</b> Standard deviation and variance</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#measures-of-relationship"><i class="fa fa-check"></i><b>5.7</b> Measures of relationship</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#correlations"><i class="fa fa-check"></i><b>5.7.1</b> Correlations</a></li>
<li class="chapter" data-level="5.7.2" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#ratios"><i class="fa fa-check"></i><b>5.7.2</b> Ratios</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#additional-topics"><i class="fa fa-check"></i><b>5.8</b> Additional topics</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#subpopulation-analysis"><i class="fa fa-check"></i><b>5.8.1</b> Subpopulation analysis</a></li>
<li class="chapter" data-level="5.8.2" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#Var-types"><i class="fa fa-check"></i><b>5.8.2</b> Variability types</a></li>
<li class="chapter" data-level="5.8.3" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#design-effects"><i class="fa fa-check"></i><b>5.8.3</b> Design effects</a></li>
<li class="chapter" data-level="5.8.4" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#creating-summary-rows"><i class="fa fa-check"></i><b>5.8.4</b> Creating summary rows</a></li>
<li class="chapter" data-level="5.8.5" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#calculating-estimates-for-many-outcomes"><i class="fa fa-check"></i><b>5.8.5</b> Calculating estimates for many outcomes</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="c05-descriptive-analysis.html"><a href="c05-descriptive-analysis.html#exercises-1"><i class="fa fa-check"></i><b>5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html"><i class="fa fa-check"></i><b>6</b> Statistical testing</a>
<ul>
<li class="chapter" data-level="" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html#prereq6"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="6.1" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html#stattest-ttest"><i class="fa fa-check"></i><b>6.2</b> Comparison of Proportions and Means</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html#stattest-ttest-syntax"><i class="fa fa-check"></i><b>6.2.1</b> Syntax</a></li>
<li class="chapter" data-level="6.2.2" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html#stattest-ttest-examples"><i class="fa fa-check"></i><b>6.2.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html#stattest-chi"><i class="fa fa-check"></i><b>6.3</b> Chi-Square Tests</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html#stattest-chi-syntax"><i class="fa fa-check"></i><b>6.3.1</b> Syntax</a></li>
<li class="chapter" data-level="6.3.2" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html#stattest-chi-examples"><i class="fa fa-check"></i><b>6.3.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="c06-statistical-testing.html"><a href="c06-statistical-testing.html#stattest-exercises"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="c07-modeling.html"><a href="c07-modeling.html"><i class="fa fa-check"></i><b>7</b> Modeling</a>
<ul>
<li class="chapter" data-level="" data-path="c07-modeling.html"><a href="c07-modeling.html#prereq7"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="7.1" data-path="c07-modeling.html"><a href="c07-modeling.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="c07-modeling.html"><a href="c07-modeling.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>7.2</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="c07-modeling.html"><a href="c07-modeling.html#syntax-10"><i class="fa fa-check"></i><b>7.2.1</b> Syntax</a></li>
<li class="chapter" data-level="7.2.2" data-path="c07-modeling.html"><a href="c07-modeling.html#example-10"><i class="fa fa-check"></i><b>7.2.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="c07-modeling.html"><a href="c07-modeling.html#gaussian-linear-regression"><i class="fa fa-check"></i><b>7.3</b> Gaussian Linear regression</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="c07-modeling.html"><a href="c07-modeling.html#syntax-11"><i class="fa fa-check"></i><b>7.3.1</b> Syntax</a></li>
<li class="chapter" data-level="7.3.2" data-path="c07-modeling.html"><a href="c07-modeling.html#example-11"><i class="fa fa-check"></i><b>7.3.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="c07-modeling.html"><a href="c07-modeling.html#logistic-regression"><i class="fa fa-check"></i><b>7.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="c07-modeling.html"><a href="c07-modeling.html#syntax-12"><i class="fa fa-check"></i><b>7.4.1</b> Syntax</a></li>
<li class="chapter" data-level="7.4.2" data-path="c07-modeling.html"><a href="c07-modeling.html#example-12"><i class="fa fa-check"></i><b>7.4.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="c07-modeling.html"><a href="c07-modeling.html#exercises-2"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html"><i class="fa fa-check"></i><b>8</b> Communicating Results</a>
<ul>
<li class="chapter" data-level="" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#prereq8"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="8.1" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#introduction-7"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#describing-results-through-text"><i class="fa fa-check"></i><b>8.2</b> Describing Results through Text</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#methodology"><i class="fa fa-check"></i><b>8.2.1</b> Methodology</a></li>
<li class="chapter" data-level="8.2.2" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#analysis"><i class="fa fa-check"></i><b>8.2.2</b> Analysis</a></li>
<li class="chapter" data-level="8.2.3" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#results"><i class="fa fa-check"></i><b>8.2.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#visualizing-data"><i class="fa fa-check"></i><b>8.3</b> Visualizing Data</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#tables"><i class="fa fa-check"></i><b>8.3.1</b> Tables</a></li>
<li class="chapter" data-level="8.3.2" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#charts-and-plots"><i class="fa fa-check"></i><b>8.3.2</b> Charts and Plots</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#reproducibility"><i class="fa fa-check"></i><b>8.4</b> Reproducibility</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#setting-random-number-seeds"><i class="fa fa-check"></i><b>8.4.1</b> Setting Random Number Seeds</a></li>
<li class="chapter" data-level="8.4.2" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#git"><i class="fa fa-check"></i><b>8.4.2</b> Git</a></li>
<li class="chapter" data-level="8.4.3" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#renv"><i class="fa fa-check"></i><b>8.4.3</b> {renv}</a></li>
<li class="chapter" data-level="8.4.4" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#quartor-markdown"><i class="fa fa-check"></i><b>8.4.4</b> Quarto/R Markdown</a></li>
<li class="chapter" data-level="8.4.5" data-path="c08-communicating-results.html"><a href="c08-communicating-results.html#the-targets-package"><i class="fa fa-check"></i><b>8.4.5</b> The {targets} package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html"><i class="fa fa-check"></i><b>9</b> National Crime Victimization Survey Vignette</a>
<ul>
<li class="chapter" data-level="" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#prereq9"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="9.1" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#introduction-8"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#data-structure"><i class="fa fa-check"></i><b>9.2</b> Data structure</a></li>
<li class="chapter" data-level="9.3" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#survey-notation"><i class="fa fa-check"></i><b>9.3</b> Survey notation</a></li>
<li class="chapter" data-level="9.4" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#data-file-preparation"><i class="fa fa-check"></i><b>9.4</b> Data file preparation</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#preparing-files-for-estimation-of-victimization-rates"><i class="fa fa-check"></i><b>9.4.1</b> Preparing files for estimation of victimization rates</a></li>
<li class="chapter" data-level="9.4.2" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#derived-demographic-variables"><i class="fa fa-check"></i><b>9.4.2</b> Derived demographic variables</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#survey-design-objects"><i class="fa fa-check"></i><b>9.5</b> Survey design objects</a></li>
<li class="chapter" data-level="9.6" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#calculating-estimates"><i class="fa fa-check"></i><b>9.6</b> Calculating estimates</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#victimization-totals"><i class="fa fa-check"></i><b>9.6.1</b> Victimization totals</a></li>
<li class="chapter" data-level="9.6.2" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#victimization-proportions"><i class="fa fa-check"></i><b>9.6.2</b> Victimization proportions</a></li>
<li class="chapter" data-level="9.6.3" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#victimization-rates"><i class="fa fa-check"></i><b>9.6.3</b> Victimization rates</a></li>
<li class="chapter" data-level="9.6.4" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#prevalence-rates"><i class="fa fa-check"></i><b>9.6.4</b> Prevalence rates</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="c09-ncvs-vignette.html"><a href="c09-ncvs-vignette.html#exercises-3"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="c10-ambarom-vignette.html"><a href="c10-ambarom-vignette.html"><i class="fa fa-check"></i><b>10</b> AmericasBarometer Vignette</a>
<ul>
<li class="chapter" data-level="" data-path="c10-ambarom-vignette.html"><a href="c10-ambarom-vignette.html#prereq10"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="10.1" data-path="c10-ambarom-vignette.html"><a href="c10-ambarom-vignette.html#introduction-9"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="c10-ambarom-vignette.html"><a href="c10-ambarom-vignette.html#data-structure-1"><i class="fa fa-check"></i><b>10.2</b> Data Structure</a></li>
<li class="chapter" data-level="10.3" data-path="c10-ambarom-vignette.html"><a href="c10-ambarom-vignette.html#preparing-files"><i class="fa fa-check"></i><b>10.3</b> Preparing files</a></li>
<li class="chapter" data-level="10.4" data-path="c10-ambarom-vignette.html"><a href="c10-ambarom-vignette.html#survey-design-objects-1"><i class="fa fa-check"></i><b>10.4</b> Survey design objects</a></li>
<li class="chapter" data-level="10.5" data-path="c10-ambarom-vignette.html"><a href="c10-ambarom-vignette.html#calculating-estimates-and-making-tables"><i class="fa fa-check"></i><b>10.5</b> Calculating estimates and making tables</a></li>
<li class="chapter" data-level="10.6" data-path="c10-ambarom-vignette.html"><a href="c10-ambarom-vignette.html#mapping-survey-data"><i class="fa fa-check"></i><b>10.6</b> Mapping survey data</a></li>
<li class="chapter" data-level="10.7" data-path="c10-ambarom-vignette.html"><a href="c10-ambarom-vignette.html#exercises-4"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tidy Survey Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c05-descriptive-analysis" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Descriptive analyses in srvyr<a href="c05-descriptive-analysis.html#c05-descriptive-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="prereq5" class="section level3 unnumbered hasAnchor prereqbox-header">
<h3>Prerequisites<a href="c05-descriptive-analysis.html#prereq5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div class="prereqbox">
<p>For this chapter, here are the libraries and helper functions we will need:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="c05-descriptive-analysis.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb98-2"><a href="c05-descriptive-analysis.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey) </span>
<span id="cb98-3"><a href="c05-descriptive-analysis.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(srvyr) </span>
<span id="cb98-4"><a href="c05-descriptive-analysis.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb98-5"><a href="c05-descriptive-analysis.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(osfr)</span>
<span id="cb98-6"><a href="c05-descriptive-analysis.html#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;helper-fun/helper-functions.R&quot;</span>)</span>
<span id="cb98-7"><a href="c05-descriptive-analysis.html#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="c05-descriptive-analysis.html#cb98-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">tidy =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>To help explain the similarities between {dplyr} functions and {srvyr} functions, this chapter will use the <code>mtcars</code> and <code>iris</code> datasets that are built-in to R and <code>apistrat</code> data that comes in the {survey} package:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="c05-descriptive-analysis.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(api)</span>
<span id="cb99-2"><a href="c05-descriptive-analysis.html#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="c05-descriptive-analysis.html#cb99-3" aria-hidden="true" tabindex="-1"></a>dstrata <span class="ot">&lt;-</span> apistrat <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="c05-descriptive-analysis.html#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(<span class="at">strata =</span> stype, <span class="at">weights =</span> pw)</span></code></pre></div>
<p>We will be using data from ANES and RECS. Here is the code to create the design objects for each to use throughout this chapter. For ANES, we need to adjust the weight so it sums to the population instead of the sample (see the ANES documentation and Chapter <a href="c04-understanding-survey-data-documentation.html#c04-understanding-survey-data-documentation">4</a> for more information).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="c05-descriptive-analysis.html#cb100-1" aria-hidden="true" tabindex="-1"></a>anes_in <span class="ot">&lt;-</span> <span class="fu">read_osf</span>(<span class="st">&quot;anes_2020.rds&quot;</span>) </span>
<span id="cb100-2"><a href="c05-descriptive-analysis.html#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="c05-descriptive-analysis.html#cb100-3" aria-hidden="true" tabindex="-1"></a>anes_adjwgt <span class="ot">&lt;-</span> anes_in <span class="sc">%&gt;%</span></span>
<span id="cb100-4"><a href="c05-descriptive-analysis.html#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Weight =</span> Weight <span class="sc">/</span> <span class="fu">sum</span>(Weight) <span class="sc">*</span> targetpop)</span>
<span id="cb100-5"><a href="c05-descriptive-analysis.html#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="c05-descriptive-analysis.html#cb100-6" aria-hidden="true" tabindex="-1"></a>anes_des <span class="ot">&lt;-</span> anes_adjwgt <span class="sc">%&gt;%</span></span>
<span id="cb100-7"><a href="c05-descriptive-analysis.html#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb100-8"><a href="c05-descriptive-analysis.html#cb100-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> Weight,</span>
<span id="cb100-9"><a href="c05-descriptive-analysis.html#cb100-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">strata =</span> Stratum,</span>
<span id="cb100-10"><a href="c05-descriptive-analysis.html#cb100-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> VarUnit,</span>
<span id="cb100-11"><a href="c05-descriptive-analysis.html#cb100-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">nest =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>For RECS, details are included in the RECS documentation and Chapter <a href="c03-specifying-sample-designs.html#c03-specifying-sample-designs">3</a>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="c05-descriptive-analysis.html#cb101-1" aria-hidden="true" tabindex="-1"></a>recs_in <span class="ot">&lt;-</span><span class="fu">read_osf</span>(<span class="st">&quot;recs_2015.rds&quot;</span>)</span>
<span id="cb101-2"><a href="c05-descriptive-analysis.html#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="c05-descriptive-analysis.html#cb101-3" aria-hidden="true" tabindex="-1"></a>recs_des <span class="ot">&lt;-</span> recs_in <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="c05-descriptive-analysis.html#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_survey_rep</span>(<span class="at">weights =</span> NWEIGHT,</span>
<span id="cb101-5"><a href="c05-descriptive-analysis.html#cb101-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">repweights =</span> <span class="fu">starts_with</span>(<span class="st">&quot;BRRWT&quot;</span>),</span>
<span id="cb101-6"><a href="c05-descriptive-analysis.html#cb101-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&quot;Fay&quot;</span>,</span>
<span id="cb101-7"><a href="c05-descriptive-analysis.html#cb101-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">rho =</span> <span class="fl">0.5</span>,</span>
<span id="cb101-8"><a href="c05-descriptive-analysis.html#cb101-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">mse =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="introduction-4" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction<a href="c05-descriptive-analysis.html#introduction-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall from Chapter <a href="c03-specifying-sample-designs.html#c03-specifying-sample-designs">3</a> the general process for estimation with the {srvyr} package:</p>
<ol style="list-style-type: decimal">
<li>Create a <code>tbl_svy</code> object using <code>srvyr::as_survey_design()</code> or <code>srvyr::as_survey_rep()</code>.</li>
<li>Subset the data for subpopulations using <code>srvyr::filter()</code>, if needed.</li>
<li>Specify domains of analysis using <code>srvyr::group_by()</code>, if needed.</li>
<li>Within <code>srvyr::summarize()</code>, specify variables to calculate means, totals, proportions, quantiles, and more.</li>
</ol>
<p>Filtering should be done after creating the <code>tbl_svy</code> object (using <code>as_survey_design()</code> or <code>as_survey_rep()</code>) because survey objects incorporate the survey design information into the resulting object.</p>
<!-- We need to add more here about why we do descriptive analysis, this chapter was missing an intro-->
</div>
<div id="similarities-between-dplyr-and-srvyr-functions" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Similarities between {dplyr} and {srvyr} functions<a href="c05-descriptive-analysis.html#similarities-between-dplyr-and-srvyr-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the major advantages of using {srvyr} is that it applies {dplyr}-like syntax to the {survey} package. We can use pipes to specify a tbl_svy object, apply a function, and then feed that output into the next function’s first argument. Functions follow the ‘tidy’ convention of snake_case functions names. In the example below, the mean and median are calculated for the variable <code>mpg</code> on the <code>mtcars</code> dataset.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="c05-descriptive-analysis.html#cb102-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="c05-descriptive-analysis.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mpg_mean =</span> <span class="fu">mean</span>(mpg),</span>
<span id="cb102-3"><a href="c05-descriptive-analysis.html#cb102-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">mpg_median =</span> <span class="fu">median</span>(mpg))</span></code></pre></div>
<pre><code>##   mpg_mean mpg_median
## 1    20.09       19.2</code></pre>
<p>Similarly, in the next example, the variance and standard deviation of the variable <code>api00</code> are calculated for the tbl_svy object <code>dstrata</code>. Note how similar the syntax is. When we dig into the functions later, we will show that the results output are similar in that one row is output for each group (if there are groups) but there will be more columns output. Specifically, by default, the standard error of the statistic is calculated in addition to the statistic.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="c05-descriptive-analysis.html#cb104-1" aria-hidden="true" tabindex="-1"></a>dstrata <span class="sc">%&gt;%</span> </span>
<span id="cb104-2"><a href="c05-descriptive-analysis.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">api00_mean =</span> <span class="fu">survey_mean</span>(api00),</span>
<span id="cb104-3"><a href="c05-descriptive-analysis.html#cb104-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">api00_med =</span> <span class="fu">survey_median</span>(api00))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   api00_mean api00_mean_se api00_med api00_med_se
##        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
## 1       662.          9.54       668         13.7</code></pre>
<p>The functions in {srvyr} also play nicely with other tidyverse functions. If we wanted to select columns that have something in common, we can use {tidyselect} functions such as <code>starts_with()</code>, <code>num_range()</code>, etc.. In the examples below, a combination of <code>across()</code> and <code>starts_with()</code> to calculate the mean of variables starting with “Sepal” in the <code>iris</code> dataframe and then starting with <code>api</code> in the <code>dstrata</code> survey object.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="c05-descriptive-analysis.html#cb106-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="c05-descriptive-analysis.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb106-3"><a href="c05-descriptive-analysis.html#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Sepal&quot;</span>), mean)</span>
<span id="cb106-4"><a href="c05-descriptive-analysis.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width
## 1        5.843       3.057</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="c05-descriptive-analysis.html#cb108-1" aria-hidden="true" tabindex="-1"></a>dstrata <span class="sc">%&gt;%</span></span>
<span id="cb108-2"><a href="c05-descriptive-analysis.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb108-3"><a href="c05-descriptive-analysis.html#cb108-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;api&quot;</span>), survey_mean)</span>
<span id="cb108-4"><a href="c05-descriptive-analysis.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   api00 api00_se api99 api99_se api.stu api.stu_se
##   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
## 1  662.     9.54  629.     10.1    498.       16.4</code></pre>
<p>We can use {dplyr} verbs such as <code>mutate()</code>, <code>filter()</code>, etc., on our survey object.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="c05-descriptive-analysis.html#cb110-1" aria-hidden="true" tabindex="-1"></a>dstrata_mod <span class="ot">&lt;-</span> dstrata <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="c05-descriptive-analysis.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">api_diff =</span> api00 <span class="sc">-</span> api99) <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="c05-descriptive-analysis.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(stype<span class="sc">==</span><span class="st">&quot;E&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="c05-descriptive-analysis.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(stype, api99, api00, api_diff, <span class="at">api_students=</span>api.stu)</span>
<span id="cb110-5"><a href="c05-descriptive-analysis.html#cb110-5" aria-hidden="true" tabindex="-1"></a>dstrata_mod</span></code></pre></div>
<pre><code>## Stratified Independent Sampling design (with replacement)
## Called via srvyr
## Sampling variables:
##  - ids: `1`
##  - strata: stype
##  - weights: pw
## Data variables: stype (fct), api99 (int), api00 (int), api_diff (int),
##   api_students (int)</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="c05-descriptive-analysis.html#cb112-1" aria-hidden="true" tabindex="-1"></a>dstrata</span></code></pre></div>
<pre><code>## Stratified Independent Sampling design (with replacement)
## Called via srvyr
## Sampling variables:
##  - ids: `1`
##  - strata: stype
##  - weights: pw
## Data variables: cds (chr), stype (fct), name (chr), sname (chr), snum
##   (dbl), dname (chr), dnum (int), cname (chr), cnum (int), flag (int),
##   pcttest (int), api00 (int), api99 (int), target (int), growth (int),
##   sch.wide (fct), comp.imp (fct), both (fct), awards (fct), meals
##   (int), ell (int), yr.rnd (fct), mobility (int), acs.k3 (int), acs.46
##   (int), acs.core (int), pct.resp (int), not.hsg (int), hsg (int),
##   some.col (int), col.grad (int), grad.sch (int), avg.ed (dbl), full
##   (int), emer (int), enroll (int), api.stu (int), pw (dbl), fpc (dbl)</code></pre>
<p>Instead of data frames or tibbles, {srvyr} functions are meant for <code>tbl_svy</code> objects. Attempting to run data manipulation on non-<code>tbl_svy</code> objects will result in an error as shown in the example below while using the mtcars data frame which is not <code>tbl_svy</code> object.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="c05-descriptive-analysis.html#cb114-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="c05-descriptive-analysis.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mpg_mean =</span> <span class="fu">survey_mean</span>(mpg))</span></code></pre></div>
<pre><code>## Error in `summarize()`:
## ℹ In argument: `mpg_mean = survey_mean(mpg)`.
## Caused by error in `cur_svy()`:
## ! Survey context not set</code></pre>
<p>A few functions in {srvyr} parallel functions in {dplyr}, such as <code>srvyr::summarize()</code> and <code>srvyr::group_by()</code>. Unlike {srvyr}-specific verbs, the package recognizes these parallel functions on a non-survey object. It will not error and instead give the equivalent output from {dplyr}:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="c05-descriptive-analysis.html#cb116-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb116-2"><a href="c05-descriptive-analysis.html#cb116-2" aria-hidden="true" tabindex="-1"></a>  srvyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mpg_mean =</span> <span class="fu">mean</span>(mpg))</span></code></pre></div>
<pre><code>##   mpg_mean
## 1    20.09</code></pre>
<p>Because this book focuses on survey analysis, most of our pipes will stem from a survey object. We will not include the namespace for each function (e.g., <code>srvyr::summarize()</code>). Several functions in {srvyr} must be called within <code>srvyr::summarize()</code> with the exception of <code>srvyr::survey_count()</code> and <code>srvyr::survey_tally()</code> much like <code>dplyr::count()</code> and <code>dplyr::tally()</code> are not called within <code>dplyr::summarize()</code>.</p>
<p>These verbs can be used in conjunction with <code>group_by()</code> or <code>by/.by</code>, applying the functions on a group-by-group basis to create grouped summaries.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="c05-descriptive-analysis.html#cb118-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span></span>
<span id="cb118-2"><a href="c05-descriptive-analysis.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="c05-descriptive-analysis.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mpg_mean =</span> <span class="fu">mean</span>(mpg))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##     cyl mpg_mean
##   &lt;dbl&gt;    &lt;dbl&gt;
## 1     4     26.7
## 2     6     19.7
## 3     8     15.1</code></pre>
<p>We use a similar setup to summarize data in {srvyr}.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="c05-descriptive-analysis.html#cb120-1" aria-hidden="true" tabindex="-1"></a>dstrata <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="c05-descriptive-analysis.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stype) <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="c05-descriptive-analysis.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">api00_mean =</span> <span class="fu">survey_mean</span>(api00),</span>
<span id="cb120-4"><a href="c05-descriptive-analysis.html#cb120-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">api00_median =</span> <span class="fu">survey_median</span>(api00))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   stype api00_mean api00_mean_se api00_median api00_median_se
##   &lt;fct&gt;      &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;
## 1 E           674.          12.5          671            20.7
## 2 H           626.          15.5          635            21.6
## 3 M           637.          16.6          648            24.1</code></pre>
</div>
<div id="deciding-on-descriptive-analyses" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Deciding on descriptive analyses<a href="c05-descriptive-analysis.html#deciding-on-descriptive-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We select measures based on the type of variable we are analyzing. Variables are classified as categorical/nominal, ordinal, and interval/ratio.</p>
<ul>
<li>Categorical/nominal data: variables with levels or descriptions that cannot be ordered, such as the region of the country (North, South, East, and West)</li>
<li>Ordinal data: variables that can be ordered, such as those from a Likert scale (strongly disagree, disagree, agree, and strongly agree)</li>
<li>Interval/ratio: variables that are counted or measured, such as the total cost of electricity
<ul>
<li>Within interval/ratio data are <em>discrete</em> variables, whose values are whole numbers, such as a count of children, and <em>continuous</em> variables, whose values can lie anywhere on an interval, such as weight.</li>
</ul></li>
</ul>
<p>If our variable is categorical, such as gender or occupation, we might use frequency counts or percentages. In contrast, if the variable is continuous, such as income or age, we might use mean, median, or standard deviation.</p>
<p>Choosing appropriate measures is important to reach valid conclusions. Different variable types have distinct properties and levels of measurement, and we cannot apply all measures to all variables.</p>
<p>Our survey data may represent categorical variables using numeric codes. For example, the North, South, East, and West regions of the United States might be coded as 1, 2, 3, and 4, respectively. Though this is a categorical variable, this variable might be automatically read as numeric values when we import our data. This can lead to the common mistake of applying <code>survey_mean()</code> to all numeric columns in the dataset, including categorical values.</p>
<p>This practice can lead to incorrect inferences because categorical variables lack a natural zero point or linear ordering, making measures like mean inappropriate. Instead, it is crucial to inspect the codebook, understand the variable type, and choose appropriate measures, such as frequency counts or percentages, to describe the data across regions.</p>
<p>Descriptive analysis can be categorized into univariate and multivariate analysis, depending on the number of variables we are analyzing. Below, we describe the descriptive analysis for single or multiple variables and the {srvyr} functions associated with the measures.</p>
</div>
<div id="measures-of-distribution" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Measures of distribution<a href="c05-descriptive-analysis.html#measures-of-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Measures of distribution describe how often an event or response occurs. These measures include counts, proportions, and totals.</p>
<ul>
<li>Examples: the proportion of students in California who did or did not receive an award based on their Academic Performance score; the estimated number of U.S. citizens who voted in the last election; the total amount of money residential households spend on electricity in a year</li>
</ul>
<p>The {srvyr} package includes several functions for determining measures of distribution and all must be called within the <code>summarize()</code> function except <code>survey_count()</code> and <code>survey_tally()</code>.</p>
<ul>
<li>The <code>survey_count()</code> and <code>survey_tally()</code> functions calculate weighted observations by group</li>
<li>The <code>survey_total()</code> function calculates totals</li>
<li>The <code>survey_prop()</code> function calculates proportions</li>
<li>The <code>survey_quantile()</code> function calculates quantiles</li>
</ul>
<div id="counts-and-cross-tabulations" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Counts and cross-tabulations<a href="c05-descriptive-analysis.html#counts-and-cross-tabulations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>survey_count()</code>, we can calculate the estimated population counts for a given variable or combination of variables. Sometimes, these are referred to as cross-tabulations or crosstabs, for short. These summaries should be applied to categorical data and is used to get estimated counts of the population size of groups from the survey.</p>
<div id="syntax" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The syntax is very similar to the <code>dplyr::count()</code> syntax; however, as noted above, it can only be called on <code>tbl_svy</code> objects. Let’s explore the syntax:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="c05-descriptive-analysis.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_count</span>(</span>
<span id="cb122-2"><a href="c05-descriptive-analysis.html#cb122-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb122-3"><a href="c05-descriptive-analysis.html#cb122-3" aria-hidden="true" tabindex="-1"></a>  ...,</span>
<span id="cb122-4"><a href="c05-descriptive-analysis.html#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">wt =</span> <span class="cn">NULL</span>,</span>
<span id="cb122-5"><a href="c05-descriptive-analysis.html#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort =</span> <span class="cn">FALSE</span>,</span>
<span id="cb122-6"><a href="c05-descriptive-analysis.html#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb122-7"><a href="c05-descriptive-analysis.html#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">.drop =</span> dplyr<span class="sc">::</span><span class="fu">group_by_drop_default</span>(x),</span>
<span id="cb122-8"><a href="c05-descriptive-analysis.html#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>)</span>
<span id="cb122-9"><a href="c05-descriptive-analysis.html#cb122-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb122-10"><a href="c05-descriptive-analysis.html#cb122-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-11"><a href="c05-descriptive-analysis.html#cb122-11" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_tally</span>(</span>
<span id="cb122-12"><a href="c05-descriptive-analysis.html#cb122-12" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb122-13"><a href="c05-descriptive-analysis.html#cb122-13" aria-hidden="true" tabindex="-1"></a>  wt,</span>
<span id="cb122-14"><a href="c05-descriptive-analysis.html#cb122-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort =</span> <span class="cn">FALSE</span>,</span>
<span id="cb122-15"><a href="c05-descriptive-analysis.html#cb122-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb122-16"><a href="c05-descriptive-analysis.html#cb122-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>)</span>
<span id="cb122-17"><a href="c05-descriptive-analysis.html#cb122-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments are:</p>
<ul>
<li><code>x</code>: a <code>tbl_svy</code> object created by <code>as_survey</code></li>
<li><code>...</code>: variables to group by, passed to <code>group_by</code></li>
<li><code>wt</code>: a variable to weight on in addition to the survey weights, defaults to <code>NULL</code></li>
<li><code>sort</code>: how to sort the variables, defaults to <code>FALSE</code></li>
<li><code>name</code>: the name of the count variable, defaults to <code>n</code></li>
<li><code>.drop</code>: whether to drop empty groups</li>
<li><code>vartype</code>: type(s) of variation estimate to calculate, defaults to <code>se</code> (standard error)</li>
</ul>
<p>We will discuss <code>vartype</code> in Section <a href="c05-descriptive-analysis.html#Var-types">5.8.2</a> as this option occurs in all functions.</p>
</div>
<div id="examples" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For an example, let’s use the Residential Energy Consumption Survey (RECS).</p>
<p>If we wanted to obtain the estimated number of households in the U.S. (the target population) using the RECS data we could use <code>survey_count()</code>. If we do not specify any variables in the <code>survey_count()</code> function, it will output the estimated population count (n) and standard error (n_se).</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="c05-descriptive-analysis.html#cb123-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="c05-descriptive-analysis.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survey_count</span>() </span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##            n   n_se
##        &lt;dbl&gt;  &lt;dbl&gt;
## 1 118208250. 0.0320</code></pre>
<p>Thus, the estimated number of households in the U.S. is 118,208,250.0005889982.</p>
<p>To calculate the estimated number of observations for subgroups, such as Region and Division, we can add the variables of interest into the function. In the example below, the estimated number of housing units by region and division is calculated. Additionally, the name of the count variable is changed to “N” from the default (“n”).</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="c05-descriptive-analysis.html#cb125-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="c05-descriptive-analysis.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survey_count</span>(Region, Division, <span class="at">name =</span> <span class="st">&quot;N&quot;</span>) </span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
##    Region    Division                   N     N_se
##    &lt;fct&gt;     &lt;fct&gt;                  &lt;dbl&gt;    &lt;dbl&gt;
##  1 Northeast New England         5628844. 0.00642 
##  2 Northeast Middle Atlantic    15377694. 0.000130
##  3 Midwest   East North Central 18094391. 0.000274
##  4 Midwest   West North Central  8277344. 0.000113
##  5 South     South Atlantic     23474851. 0.00555 
##  6 South     East South Central  7197189. 0.0240  
##  7 South     West South Central 13769934. 0.000423
##  8 West      Mountain North      4246877. 0.000147
##  9 West      Mountain South      4266870. 0.0193  
## 10 West      Pacific            17874256. 0.000481</code></pre>
<p>When we run the crosstab, we see there are an estimated 5,628,844.0000229999423 housing units in the New England Division.</p>
<p>The <code>survey_tally()</code> function is similar to the <code>survey_count()</code>, but the <code>survey_tally()</code> function lacks the following arguments <code>...</code> (used to specify the by groups) and <code>.drop</code>. To get the estimated overall population, <code>survey_count()</code> and <code>survey_total()</code> will be identical and the example below yields the same results as using <code>survey_count()</code> previously.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="c05-descriptive-analysis.html#cb127-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="c05-descriptive-analysis.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survey_tally</span>() </span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##            n   n_se
##        &lt;dbl&gt;  &lt;dbl&gt;
## 1 118208250. 0.0320</code></pre>
<p>However, if we wanted the estimated population total by region and division, we will get an error if we try to use the same syntax:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="c05-descriptive-analysis.html#cb129-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="c05-descriptive-analysis.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survey_tally</span>(Region, Division, <span class="at">name =</span> <span class="st">&quot;N&quot;</span>) </span></code></pre></div>
<pre><code>## Error in `dplyr::summarise()`:
## ℹ In argument: `N = survey_total(Region, vartype = vartype,
##   na.rm = TRUE)`.
## Caused by error:
## ! Factor not allowed in survey functions, should be used as a grouping variable.</code></pre>
<p>Instead, use a the <code>group_by()</code> function prior to using <code>survey_tally()</code> as is illustrated below:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="c05-descriptive-analysis.html#cb131-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="c05-descriptive-analysis.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, Division) <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="c05-descriptive-analysis.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">survey_tally</span>(<span class="at">name =</span> <span class="st">&quot;N&quot;</span>) </span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
## # Groups:   Region [4]
##    Region    Division                   N     N_se
##    &lt;fct&gt;     &lt;fct&gt;                  &lt;dbl&gt;    &lt;dbl&gt;
##  1 Northeast New England         5628844. 0.00642 
##  2 Northeast Middle Atlantic    15377694. 0.000130
##  3 Midwest   East North Central 18094391. 0.000274
##  4 Midwest   West North Central  8277344. 0.000113
##  5 South     South Atlantic     23474851. 0.00555 
##  6 South     East South Central  7197189. 0.0240  
##  7 South     West South Central 13769934. 0.000423
##  8 West      Mountain North      4246877. 0.000147
##  9 West      Mountain South      4266870. 0.0193  
## 10 West      Pacific            17874256. 0.000481</code></pre>
</div>
</div>
<div id="totals-and-sums" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Totals and sums<a href="c05-descriptive-analysis.html#totals-and-sums" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>survey_total()</code> function is analogous to <code>sum</code>. This can be used to find the estimated aggregate sum of an outcome and should be applied to continuous variables to obtain the estimated total quantity in a population. All the functions introduced henceforth in this chapter must be called from within <code>summarize()</code>.</p>
<div id="syntax-1" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s explore the syntax:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="c05-descriptive-analysis.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_total</span>(</span>
<span id="cb133-2"><a href="c05-descriptive-analysis.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb133-3"><a href="c05-descriptive-analysis.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">FALSE</span>,</span>
<span id="cb133-4"><a href="c05-descriptive-analysis.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>),</span>
<span id="cb133-5"><a href="c05-descriptive-analysis.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb133-6"><a href="c05-descriptive-analysis.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">deff =</span> <span class="cn">FALSE</span>,</span>
<span id="cb133-7"><a href="c05-descriptive-analysis.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="cn">NULL</span></span>
<span id="cb133-8"><a href="c05-descriptive-analysis.html#cb133-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments are:</p>
<ul>
<li><code>x</code>: a variable, expression, or empty</li>
<li><code>na.rm</code>: an indicator of whether missing values should be dropped, defaults to <code>FALSE</code></li>
<li><code>vartype</code>: type(s) of variation estimate to calculate, defaults to <code>se</code> (standard error)</li>
<li><code>level</code>: a number or a vector indicating the confidence level, defaults to 0.95</li>
<li><code>deff</code>: a logical value stating whether the design effect should be returned, defaults to FALSE</li>
<li><code>df</code>: (for <code>vartype = 'ci'</code>), a numeric value indicating degrees of freedom for the t-distribution</li>
</ul>
</div>
<div id="examples-1" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To calculate a population count estimate with <code>survey_total()</code>, the argument <code>x</code> can be left empty as shown in the example below::</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="c05-descriptive-analysis.html#cb134-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb134-2"><a href="c05-descriptive-analysis.html#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">survey_total</span>())  </span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##         coef  `_se`
##        &lt;dbl&gt;  &lt;dbl&gt;
## 1 118208250. 0.0320</code></pre>
<p>Note that the result from <code>recs_des %&gt;% summarize(survey_total())</code> is equivalent to the <code>survey_count()</code> call. However, the <code>survey_total()</code> function is called within <code>summarize</code>, where as <code>survey_count()</code>, like <code>dplyr::count()</code>, is not.</p>
<p>The difference between <code>survey_total()</code> and <code>survey_count()</code> is more evident when specifying continuous variables to sum. Let’s compute the total cost of electricity in whole dollars from variable <code>DOLLAREL</code><a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a>. We also calculate an unweighted estimate using <code>unweighted()</code>. The <code>unweighted()</code> function calculates unweighted summaries from <code>tbl_svy</code> object which reflects the summary among the <strong>respondents</strong> and does not extrapolate to a population estimate.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="c05-descriptive-analysis.html#cb136-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb136-2"><a href="c05-descriptive-analysis.html#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb136-3"><a href="c05-descriptive-analysis.html#cb136-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_bill =</span> <span class="fu">survey_total</span>(DOLLAREL),</span>
<span id="cb136-4"><a href="c05-descriptive-analysis.html#cb136-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_unweight =</span> <span class="fu">unweighted</span>(<span class="fu">sum</span>(DOLLAREL))</span>
<span id="cb136-5"><a href="c05-descriptive-analysis.html#cb136-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##       elec_bill elec_bill_se elec_unweight
##           &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
## 1 162495237023.  1666895091.      7981888.</code></pre>
<p>It is estimated that American residential households spent a total of $162,495,237,022.94540405 on electricity in 2015 and the estimate has a standard error of $1,666,895,091.0112884045. The unweighted function calculates unweighted counts and illustrates the total amount of money the respondents spent on electricity in 2015 which was $7,981,887.75.</p>
<p>Since we are using the {srvyr} package, we can use <code>group_by()</code> to calculate the cost of electricity by different groups. Let’s see how much the cost of electricity in whole dollars differed between regions:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="c05-descriptive-analysis.html#cb138-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb138-2"><a href="c05-descriptive-analysis.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb138-3"><a href="c05-descriptive-analysis.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">elec_bill =</span> <span class="fu">survey_total</span>(DOLLAREL))   </span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   Region       elec_bill elec_bill_se
##   &lt;fct&gt;            &lt;dbl&gt;        &lt;dbl&gt;
## 1 Northeast 28271369286.   717993322.
## 2 Midwest   31527659004.   533527154.
## 3 South     72463508778.  1124624320.
## 4 West      30232699955.   851286976.</code></pre>
<p>It’s estimated that households in the Northeast spent $28,271,369,286 on electricity in 2015 while households in the South spent an estimated $72,463,508,778.</p>
</div>
</div>
<div id="proportions" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Proportions<a href="c05-descriptive-analysis.html#proportions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To find estimated proportions in a population, the <code>survey_prop()</code> function should be used. This should be applied to a categorical variable.</p>
<div id="syntax-2" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="c05-descriptive-analysis.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_prop</span>(</span>
<span id="cb140-2"><a href="c05-descriptive-analysis.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>),</span>
<span id="cb140-3"><a href="c05-descriptive-analysis.html#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb140-4"><a href="c05-descriptive-analysis.html#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">proportion =</span> <span class="cn">TRUE</span>,</span>
<span id="cb140-5"><a href="c05-descriptive-analysis.html#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop_method =</span> <span class="fu">c</span>(<span class="st">&quot;logit&quot;</span>, <span class="st">&quot;likelihood&quot;</span>, <span class="st">&quot;asin&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;xlogit&quot;</span>),</span>
<span id="cb140-6"><a href="c05-descriptive-analysis.html#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">deff =</span> <span class="cn">FALSE</span>,</span>
<span id="cb140-7"><a href="c05-descriptive-analysis.html#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="cn">NULL</span></span>
<span id="cb140-8"><a href="c05-descriptive-analysis.html#cb140-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments are:</p>
<ul>
<li><code>na.rm</code>: an indicator of whether missing values should be dropped, defaults to <code>FALSE</code></li>
<li><code>vartype</code>: type(s) of variation estimate to calculate, defaults to <code>se</code> (standard error)</li>
<li><code>level</code>: a number or a vector indicating the confidence level, defaults to 0.95</li>
<li><code>proportion</code>: an indicator of whether the estimate is a proportion. Defaults to <code>TRUE</code>. Only impacts confidence intervals</li>
<li><code>prop_method</code>: Method to calculate confidence interval for confidence intervals. More details in <a href="c05-descriptive-analysis.html#Var-types">5.8.2</a></li>
<li><code>deff</code>: a logical value stating whether the design effect should be returned, defaults to FALSE</li>
<li><code>df</code>: (for <code>vartype = 'ci'</code>), a numeric value indicating degrees of freedom for the t-distribution</li>
</ul>
<p>Prior to usage, use the <code>group_by()</code> function to specify the categories of interest.</p>
</div>
<div id="examples-2" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="c05-descriptive-analysis.html#cb141-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="c05-descriptive-analysis.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb141-3"><a href="c05-descriptive-analysis.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p=</span><span class="fu">survey_prop</span>()) </span></code></pre></div>
<pre><code>## When `proportion` is unspecified, `survey_prop()` now defaults to `proportion = TRUE`.
## ℹ This should improve confidence interval coverage.
## This message is displayed once per session.</code></pre>
<pre><code>## # A tibble: 4 × 3
##   Region        p     p_se
##   &lt;fct&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 Northeast 0.178 6.84e-11
## 2 Midwest   0.223 6.07e-11
## 3 South     0.376 1.43e-10
## 4 West      0.223 1.37e-10</code></pre>
<p>17.7708% of the households are in the Northeast, 22.3096% in the Midwest, and so on.</p>
<p>Note: <code>survey_prop()</code> is essentially the same as using <code>survey_mean()</code> (discussed later) with a categorical variable and without specifying a numeric variable in the <code>x</code> argument. The following code will give us the same results as above:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="c05-descriptive-analysis.html#cb144-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb144-2"><a href="c05-descriptive-analysis.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="c05-descriptive-analysis.html#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p=</span><span class="fu">survey_mean</span>())</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   Region        p     p_se
##   &lt;fct&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 Northeast 0.178 6.84e-11
## 2 Midwest   0.223 6.07e-11
## 3 South     0.376 1.43e-10
## 4 West      0.223 1.37e-10</code></pre>
<p>Getting proportions by more than one variable is possible. In the next example, we look at the proportion of housing units by Region and whether air-conditioning is used (<code>ACUsed</code>).<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="c05-descriptive-analysis.html#cb146-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb146-2"><a href="c05-descriptive-analysis.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, ACUsed) <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="c05-descriptive-analysis.html#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p=</span><span class="fu">survey_mean</span>())</span></code></pre></div>
<pre><code>## # A tibble: 8 × 4
## # Groups:   Region [4]
##   Region    ACUsed      p    p_se
##   &lt;fct&gt;     &lt;lgl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 Northeast FALSE  0.151  0.0200 
## 2 Northeast TRUE   0.849  0.0200 
## 3 Midwest   FALSE  0.0766 0.00957
## 4 Midwest   TRUE   0.923  0.00957
## 5 South     FALSE  0.0511 0.00649
## 6 South     TRUE   0.949  0.00649
## 7 West      FALSE  0.301  0.0298 
## 8 West      TRUE   0.699  0.0298</code></pre>
<p>When specifying multiple variables, the proportions are conditional. In the results above, notice that the proportions sum to 1 within each region. This can be interpreted as the proportion of housing units that have air conditioning WITHIN each region. If we want the joint proportion instead, the interact function is necessary. In the example below, the interact function is used on <code>Region</code> and <code>ACUsed</code>:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="c05-descriptive-analysis.html#cb148-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb148-2"><a href="c05-descriptive-analysis.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">interact</span>(Region, ACUsed)) <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="c05-descriptive-analysis.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p=</span><span class="fu">survey_mean</span>())</span></code></pre></div>
<pre><code>## # A tibble: 8 × 4
##   Region    ACUsed      p    p_se
##   &lt;fct&gt;     &lt;lgl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 Northeast FALSE  0.0268 0.00355
## 2 Northeast TRUE   0.151  0.00355
## 3 Midwest   FALSE  0.0171 0.00214
## 4 Midwest   TRUE   0.206  0.00214
## 5 South     FALSE  0.0192 0.00244
## 6 South     TRUE   0.357  0.00244
## 7 West      FALSE  0.0672 0.00665
## 8 West      TRUE   0.156  0.00665</code></pre>
</div>
</div>
<div id="quantiles" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Quantiles<a href="c05-descriptive-analysis.html#quantiles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>survey_quantile()</code> function can be used to find the estimated quantiles of a continuous outcome. For example, we might want estimates of the quartiles of income in a population to understand how the income is distributed.</p>
<div id="syntax-3" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s explore the syntax:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="c05-descriptive-analysis.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_quantile</span>(</span>
<span id="cb150-2"><a href="c05-descriptive-analysis.html#cb150-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb150-3"><a href="c05-descriptive-analysis.html#cb150-3" aria-hidden="true" tabindex="-1"></a>  quantiles,</span>
<span id="cb150-4"><a href="c05-descriptive-analysis.html#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">FALSE</span>,</span>
<span id="cb150-5"><a href="c05-descriptive-analysis.html#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>),</span>
<span id="cb150-6"><a href="c05-descriptive-analysis.html#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb150-7"><a href="c05-descriptive-analysis.html#cb150-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval_type =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;xlogit&quot;</span>, <span class="st">&quot;asin&quot;</span>, <span class="st">&quot;score&quot;</span>, <span class="st">&quot;quantile&quot;</span>),</span>
<span id="cb150-8"><a href="c05-descriptive-analysis.html#cb150-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">qrule =</span> <span class="fu">c</span>(<span class="st">&quot;math&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="st">&quot;shahvaish&quot;</span>, <span class="st">&quot;hf1&quot;</span>, <span class="st">&quot;hf2&quot;</span>, <span class="st">&quot;hf3&quot;</span>, <span class="st">&quot;hf4&quot;</span>, <span class="st">&quot;hf5&quot;</span>, <span class="st">&quot;hf6&quot;</span>,</span>
<span id="cb150-9"><a href="c05-descriptive-analysis.html#cb150-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hf7&quot;</span>, <span class="st">&quot;hf8&quot;</span>, <span class="st">&quot;hf9&quot;</span>),</span>
<span id="cb150-10"><a href="c05-descriptive-analysis.html#cb150-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="cn">NULL</span></span>
<span id="cb150-11"><a href="c05-descriptive-analysis.html#cb150-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments are:</p>
<ul>
<li><code>x</code>: a variable, expression, or empty</li>
<li><code>quantiles</code>: A vector of quantiles to calculate</li>
<li><code>na.rm</code>: an indicator of whether missing values should be dropped, defaults to <code>FALSE</code></li>
<li><code>vartype</code>: type(s) of variation estimate to calculate, defaults to <code>se</code> (standard error)</li>
<li><code>level</code>: a number or a vector indicating the confidence level, defaults to 0.95</li>
<li><code>interval_type</code>: method for calculating confidence interval. More details in <a href="c05-descriptive-analysis.html#Var-types">5.8.2</a>.</li>
<li><code>qrule</code>: rule for defining quantiles. The default is the lower end of the quantile interval (“math”). The midpoint of the quantile interval is the “school” rule. “hf1” to “hf9” are weighted analogues to type=1 to 9 in <code>quantile()</code>. “shahvaish” corresponds to a rule proposed by <span class="citation">Shah and Vaish (<a href="#ref-shahvaish" role="doc-biblioref">2006</a>)</span>. See <code>vignette("qrule", package="survey")</code> for more information.</li>
<li><code>df</code>: (for <code>vartype = 'ci'</code>), a numeric value indicating degrees of freedom for the t-distribution</li>
</ul>
</div>
<div id="examples-3" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Quantiles are useful in learning about the distribution of an outcome. Let’s look into the quartiles, specifically, the first quartile (p=0.25), the median (p=0.5) and the third quartile (p=0.75) of electric bills.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="c05-descriptive-analysis.html#cb151-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb151-2"><a href="c05-descriptive-analysis.html#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">elec_bill =</span> <span class="fu">survey_quantile</span>(DOLLAREL, <span class="at">quantiles=</span><span class="fu">c</span>(<span class="fl">0.25</span>, .<span class="dv">5</span>, <span class="fl">0.75</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   elec_bill_q25 elec_bill_q50 elec_bill_q75 elec_bill_q25_se
##           &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;
## 1           795         1219.         1790.             12.5
## # ℹ 2 more variables: elec_bill_q50_se &lt;dbl&gt;, elec_bill_q75_se &lt;dbl&gt;</code></pre>
<p>In the output above, we see the 3 quartiles and their respective standard errors. We can also estimate the quantiles of electric bills by region as shown below:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="c05-descriptive-analysis.html#cb153-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="c05-descriptive-analysis.html#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="c05-descriptive-analysis.html#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb153-4"><a href="c05-descriptive-analysis.html#cb153-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_bill =</span> <span class="fu">survey_quantile</span>(DOLLAREL, <span class="at">quantiles=</span><span class="fu">c</span>(<span class="fl">0.25</span>, .<span class="dv">5</span>, <span class="fl">0.75</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 7
##   Region    elec_bill_q25 elec_bill_q50 elec_bill_q75 elec_bill_q25_se
##   &lt;fct&gt;             &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;
## 1 Northeast          749.         1190.         1741.             19.4
## 2 Midwest            738.         1067.         1524.             24.2
## 3 South             1041          1503.         2091.             21.7
## 4 West               605.          941.         1502.             18.8
## # ℹ 2 more variables: elec_bill_q50_se &lt;dbl&gt;, elec_bill_q75_se &lt;dbl&gt;</code></pre>
<p>While we can specify quantiles of 0 and 1 which represent the minimum and maximum, this is not recommended. It only returns the minimum and maximum of the respondents and cannot be extrapolated to the population as there is no valid definition of standard error.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="c05-descriptive-analysis.html#cb155-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="c05-descriptive-analysis.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb155-3"><a href="c05-descriptive-analysis.html#cb155-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_bill =</span> <span class="fu">survey_quantile</span>(DOLLAREL, <span class="at">quantiles=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   elec_bill_q00 elec_bill_q100 elec_bill_q00_se elec_bill_q100_se
##           &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;             &lt;dbl&gt;
## 1          21.8          8122.              NaN                 0</code></pre>
</div>
</div>
</div>
<div id="measures-of-central-tendency" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Measures of central tendency<a href="c05-descriptive-analysis.html#measures-of-central-tendency" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Measures of central tendency find the central (or average) responses. These include the mean, median, and mode.</p>
<ul>
<li>Examples: Average 2000 Academic Performance Index in California, the median house price in Canada</li>
</ul>
<p>The {srvyr} package includes functions for estimating the mean and median, and they must be called within the <code>summarize()</code> function.</p>
<ul>
<li>The <code>survey_mean()</code> function calculates means</li>
<li>The <code>survey_median()</code> function calculates medians</li>
</ul>
<div id="means" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Means<a href="c05-descriptive-analysis.html#means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>survey_mean()</code> function calculate the estimated means of continuous variables of survey data.</p>
<div id="syntax-4" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s explore the syntax:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="c05-descriptive-analysis.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_mean</span>(</span>
<span id="cb157-2"><a href="c05-descriptive-analysis.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb157-3"><a href="c05-descriptive-analysis.html#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">FALSE</span>,</span>
<span id="cb157-4"><a href="c05-descriptive-analysis.html#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>),</span>
<span id="cb157-5"><a href="c05-descriptive-analysis.html#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb157-6"><a href="c05-descriptive-analysis.html#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">proportion =</span> <span class="cn">FALSE</span>,</span>
<span id="cb157-7"><a href="c05-descriptive-analysis.html#cb157-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop_method =</span> <span class="fu">c</span>(<span class="st">&quot;logit&quot;</span>, <span class="st">&quot;likelihood&quot;</span>, <span class="st">&quot;asin&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;mean&quot;</span>),</span>
<span id="cb157-8"><a href="c05-descriptive-analysis.html#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">deff =</span> <span class="cn">FALSE</span>,</span>
<span id="cb157-9"><a href="c05-descriptive-analysis.html#cb157-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="cn">NULL</span></span>
<span id="cb157-10"><a href="c05-descriptive-analysis.html#cb157-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments are:</p>
<ul>
<li><code>x</code>: a variable, expression, or empty</li>
<li><code>na.rm</code>: an indicator of whether missing values should be dropped, defaults to <code>FALSE</code></li>
<li><code>vartype</code>: type(s) of variation estimate to calculate, defaults to <code>se</code> (standard error)</li>
<li><code>level</code>: a number or a vector indicating the confidence level, defaults to 0.95</li>
<li><code>proportion</code>: an indicator of whether the estimate is a proportion. Defaults to <code>FALSE</code></li>
<li><code>prop_method</code>: Method to calculate confidence interval for confidence intervals. More details in <a href="c05-descriptive-analysis.html#Var-types">5.8.2</a></li>
<li><code>deff</code>: a logical value stating whether the design effect should be returned, defaults to FALSE</li>
<li><code>df</code>: (for <code>vartype = 'ci'</code>), a numeric value indicating degrees of freedom for the t-distribution</li>
</ul>
</div>
<div id="examples-4" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can calculate the estimated average cost of electricity in the U.S. and then for each region in the U.S.:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="c05-descriptive-analysis.html#cb158-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="c05-descriptive-analysis.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">elec_bill =</span> <span class="fu">survey_mean</span>(DOLLAREL))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   elec_bill elec_bill_se
##       &lt;dbl&gt;        &lt;dbl&gt;
## 1     1375.         14.1</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="c05-descriptive-analysis.html#cb160-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb160-2"><a href="c05-descriptive-analysis.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb160-3"><a href="c05-descriptive-analysis.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">elec_bill =</span> <span class="fu">survey_mean</span>(DOLLAREL))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   Region    elec_bill elec_bill_se
##   &lt;fct&gt;         &lt;dbl&gt;        &lt;dbl&gt;
## 1 Northeast     1346.         34.2
## 2 Midwest       1196.         20.2
## 3 South         1631.         25.3
## 4 West          1146.         32.3</code></pre>
<p>Nationally, the average household spent $1,375 in 2015 with some variability by region.
Households from the West spent $1,146 on electricity and in the South, they spent an average of $1,631.</p>
</div>
</div>
<div id="medians" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Medians<a href="c05-descriptive-analysis.html#medians" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The median is another measure of central tendency which provides an estimate of the midpoint of a continuous distribution. Medians are less subject to outliers than means.</p>
<div id="syntax-5" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The syntax is nearly identical to <code>survey_quantile()</code> as the median is a special quantile with p=0.5.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="c05-descriptive-analysis.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_median</span>(</span>
<span id="cb162-2"><a href="c05-descriptive-analysis.html#cb162-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb162-3"><a href="c05-descriptive-analysis.html#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">FALSE</span>,</span>
<span id="cb162-4"><a href="c05-descriptive-analysis.html#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>),</span>
<span id="cb162-5"><a href="c05-descriptive-analysis.html#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb162-6"><a href="c05-descriptive-analysis.html#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval_type =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;xlogit&quot;</span>, <span class="st">&quot;asin&quot;</span>, <span class="st">&quot;score&quot;</span>, <span class="st">&quot;quantile&quot;</span>),</span>
<span id="cb162-7"><a href="c05-descriptive-analysis.html#cb162-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">qrule =</span> <span class="fu">c</span>(<span class="st">&quot;math&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="st">&quot;shahvaish&quot;</span>, <span class="st">&quot;hf1&quot;</span>, <span class="st">&quot;hf2&quot;</span>, <span class="st">&quot;hf3&quot;</span>, <span class="st">&quot;hf4&quot;</span>, <span class="st">&quot;hf5&quot;</span>, <span class="st">&quot;hf6&quot;</span>,</span>
<span id="cb162-8"><a href="c05-descriptive-analysis.html#cb162-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hf7&quot;</span>, <span class="st">&quot;hf8&quot;</span>, <span class="st">&quot;hf9&quot;</span>),</span>
<span id="cb162-9"><a href="c05-descriptive-analysis.html#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="cn">NULL</span></span>
<span id="cb162-10"><a href="c05-descriptive-analysis.html#cb162-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments are:</p>
<ul>
<li><code>x</code>: a variable, expression, or empty</li>
<li><code>na.rm</code>: an indicator of whether missing values should be dropped, defaults to <code>FALSE</code></li>
<li><code>vartype</code>: type(s) of variation estimate to calculate, defaults to <code>se</code> (standard error)</li>
<li><code>level</code>: a number or a vector indicating the confidence level, defaults to 0.95</li>
<li><code>interval_type</code>: method for calculating confidence interval. More details in <a href="c05-descriptive-analysis.html#Var-types">5.8.2</a>.</li>
<li><code>qrule</code>: rule for defining quantiles. The default is the lower end of the quantile interval (“math”). The midpoint of the quantile interval is the “school” rule. “hf1” to “hf9” are weighted analogues to type=1 to 9 in <code>quantile()</code>. “shahvaish” corresponds to a rule proposed by <span class="citation">Shah and Vaish (<a href="#ref-shahvaish" role="doc-biblioref">2006</a>)</span>. See <code>vignette("qrule", package="survey")</code> for more information.</li>
<li><code>df</code>: (for <code>vartype = 'ci'</code>), a numeric value indicating degrees of freedom for the t-distribution</li>
</ul>
</div>
<div id="examples-5" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can calculate the estimated median cost of electricity in the U.S. and then for each region in the U.S.:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="c05-descriptive-analysis.html#cb163-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="c05-descriptive-analysis.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">elec_bill =</span> <span class="fu">survey_median</span>(DOLLAREL))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   elec_bill elec_bill_se
##       &lt;dbl&gt;        &lt;dbl&gt;
## 1     1219.         17.3</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="c05-descriptive-analysis.html#cb165-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb165-2"><a href="c05-descriptive-analysis.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="c05-descriptive-analysis.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">elec_bill =</span> <span class="fu">survey_median</span>(DOLLAREL))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   Region    elec_bill elec_bill_se
##   &lt;fct&gt;         &lt;dbl&gt;        &lt;dbl&gt;
## 1 Northeast     1190.         36.3
## 2 Midwest       1067.         28.0
## 3 South         1503.         28.0
## 4 West           941.         28.8</code></pre>
<p>Nationally, the median household spent $1,219 in 2015 with some variability by region.
Households from the West spent $941 on electricity and in the South, they spent an average of $1,503.</p>
<p>Note that the 50<sup>th</sup> percentile and the median are the same, as expected. The average electric bill for households was $1,375 but the estimated median electric bill is $1,219 indicating the distribution is likely right skewed.</p>
</div>
</div>
</div>
<div id="measures-of-dispersion" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Measures of dispersion<a href="c05-descriptive-analysis.html#measures-of-dispersion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Measures of dispersion describe how data spreads around the central tendency for continuous variables. These measures include the standard deviation, variance, and range.</p>
<ul>
<li><p>Examples: The standard deviation of the 2000 Academic Performance Index in California, the variance of electricity expenditure in Ohio</p></li>
<li><p>The <code>survey_var()</code> function calculates variances</p></li>
<li><p>The <code>survey_sd()</code> function calculates standard deviations</p></li>
</ul>
<p>It should be noted these are estimates of the population variance and population standard deviation. These are not standard errors of another estimate. In our experience, these are sometimes used when designing a future study as understanding the variability in the population can help inform the precision of a future sampling design.</p>
<div id="standard-deviation-and-variance" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Standard deviation and variance<a href="c05-descriptive-analysis.html#standard-deviation-and-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The standard deviation estimate is simply the square root of the variance estimate and thus the functions have the same arguments except the standard deviation does not allow the usage of <code>vartype</code>.</p>
<div id="syntax-6" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The syntax is as follows:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="c05-descriptive-analysis.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_var</span>(</span>
<span id="cb167-2"><a href="c05-descriptive-analysis.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb167-3"><a href="c05-descriptive-analysis.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">FALSE</span>,</span>
<span id="cb167-4"><a href="c05-descriptive-analysis.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>),</span>
<span id="cb167-5"><a href="c05-descriptive-analysis.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb167-6"><a href="c05-descriptive-analysis.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="cn">NULL</span></span>
<span id="cb167-7"><a href="c05-descriptive-analysis.html#cb167-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb167-8"><a href="c05-descriptive-analysis.html#cb167-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-9"><a href="c05-descriptive-analysis.html#cb167-9" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_sd</span>(</span>
<span id="cb167-10"><a href="c05-descriptive-analysis.html#cb167-10" aria-hidden="true" tabindex="-1"></a>  x, </span>
<span id="cb167-11"><a href="c05-descriptive-analysis.html#cb167-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">FALSE</span></span>
<span id="cb167-12"><a href="c05-descriptive-analysis.html#cb167-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments are:</p>
<ul>
<li><code>x</code>: A variable or expression, or empty</li>
<li><code>na.rm</code>: A logical value to indicate whether missing values should be dropped</li>
<li><code>vartype</code>: Report variability as one or more of: standard error (“se”, default) or variance (“var”) (confidence intervals and coefficient of variation not available).</li>
<li><code>level</code>: (For vartype = “ci” only) A single number or vector of numbers indicating the confidence level.</li>
<li><code>df</code>: (For vartype = “ci” only) A numeric value indicating the degrees of freedom for t-distribution</li>
</ul>
</div>
<div id="examples-6" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Returning to electricity bills, we look at the amount of variability in electricity expenditure.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="c05-descriptive-analysis.html#cb168-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb168-2"><a href="c05-descriptive-analysis.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb168-3"><a href="c05-descriptive-analysis.html#cb168-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_elbill =</span> <span class="fu">survey_var</span>(DOLLAREL),</span>
<span id="cb168-4"><a href="c05-descriptive-analysis.html#cb168-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_elbill =</span> <span class="fu">survey_sd</span>(DOLLAREL)</span>
<span id="cb168-5"><a href="c05-descriptive-analysis.html#cb168-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: There were 2 warnings in `dplyr::summarise()`.
## The first warning was:
## ℹ In argument: `var_elbill = survey_var(DOLLAREL)`.
## Caused by warning in `thetas - meantheta`:
## ! Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
## ℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</code></pre>
<pre><code>## # A tibble: 1 × 3
##   var_elbill var_elbill_se sd_elbill
##        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
## 1    647540.        27163.      805.</code></pre>
<p>A warning message may be displayed if using a replicate design. Your results are still valid. The results above give an estimate of the population variance of electricity bills (<code>var_elbill</code>), the standard error of that variance (<code>var_elbill_se</code>), and the estimated population standard deviation of electricity bills. Note that there is no standard error associated with the standard deviation - this is the only estimate that does not include a standard error.</p>
<p>Like other estimates, we can calculate the variance by region. This would be useful to learn if the variability is similar across regions:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="c05-descriptive-analysis.html#cb171-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb171-2"><a href="c05-descriptive-analysis.html#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb171-3"><a href="c05-descriptive-analysis.html#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb171-4"><a href="c05-descriptive-analysis.html#cb171-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">var_elbill =</span> <span class="fu">survey_var</span>(DOLLAREL),</span>
<span id="cb171-5"><a href="c05-descriptive-analysis.html#cb171-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_elbill =</span> <span class="fu">survey_sd</span>(DOLLAREL)</span>
<span id="cb171-6"><a href="c05-descriptive-analysis.html#cb171-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: There were 8 warnings in `dplyr::summarise()`.
## The first warning was:
## ℹ In argument: `var_elbill = survey_var(DOLLAREL)`.
## ℹ In group 1: `Region = Northeast`.
## Caused by warning in `thetas - meantheta`:
## ! Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
## ℹ Run `dplyr::last_dplyr_warnings()` to see the 7 remaining warnings.</code></pre>
<pre><code>## # A tibble: 4 × 4
##   Region    var_elbill var_elbill_se sd_elbill
##   &lt;fct&gt;          &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
## 1 Northeast    714269.        54305.      845.
## 2 Midwest      410548.        26708.      641.
## 3 South        682280.        54320.      826.
## 4 West         578803.        39280.      761.</code></pre>
</div>
</div>
</div>
<div id="measures-of-relationship" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Measures of relationship<a href="c05-descriptive-analysis.html#measures-of-relationship" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Measures of relationship describe how variables relate to each other. In this section, we present two measures - the Pearson’s correlation (simply referred to correlation henceforth) and the ratio.</p>
<ul>
<li><p>Examples: Correlation between house square footage and electricity expenditure. Ratio of number of diseased teeth to total teeth.</p></li>
<li><p>The <code>survey_corr()</code> function calculates the Pearson’s correlation between two variables</p></li>
<li><p>The <code>survey_ratio()</code> function calculates ratio between two variables</p></li>
</ul>
<div id="correlations" class="section level3 hasAnchor" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Correlations<a href="c05-descriptive-analysis.html#correlations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The correlation is a measure of linear relationship between two continuous variables which ranges between -1 and 1. A sample correlation for a simple random sample is calculated as:</p>
<p><span class="math display">\[\frac{\sum (x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum (x_i-\bar{x})^2} \sqrt{\sum(y_i-\bar{y})^2}} \]</span>
When using <code>survey_corr()</code>, for designs other than a simple random sample, the weights are applied when estimating the correlation.</p>
<div id="syntax-7" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The syntax for <code>survey_corr()</code> is as follows:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="c05-descriptive-analysis.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_corr</span>(</span>
<span id="cb174-2"><a href="c05-descriptive-analysis.html#cb174-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb174-3"><a href="c05-descriptive-analysis.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  y,</span>
<span id="cb174-4"><a href="c05-descriptive-analysis.html#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">FALSE</span>,</span>
<span id="cb174-5"><a href="c05-descriptive-analysis.html#cb174-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>),</span>
<span id="cb174-6"><a href="c05-descriptive-analysis.html#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb174-7"><a href="c05-descriptive-analysis.html#cb174-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="cn">NULL</span></span>
<span id="cb174-8"><a href="c05-descriptive-analysis.html#cb174-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments are:</p>
<ul>
<li><code>x</code>: A variable or expression</li>
<li><code>y</code>: A variable or expression</li>
<li><code>na.rm</code>: A logical value to indicate whether missing values should be dropped</li>
<li><code>vartype</code>: NULL to report no variability. Otherwise one or more of: standard error (“se”, the default), confidence interval (“ci”), variance (“var”) or coefficient of variation (“cv”).</li>
<li><code>level</code>: (For vartype = “ci” only) A single number or vector of numbers indicating the confidence level</li>
<li><code>df</code>: (For vartype = “ci” only) A numeric value indicating the degrees of freedom for t-distribution</li>
</ul>
</div>
<div id="examples-7" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can calculate the correlation between total square footage (<code>TOTSQFT_EN</code>)<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> and electricity consumption (<code>BTUEL</code>)<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="c05-descriptive-analysis.html#cb175-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb175-2"><a href="c05-descriptive-analysis.html#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb175-3"><a href="c05-descriptive-analysis.html#cb175-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">SQFT_Elec_Corr=</span><span class="fu">survey_corr</span>(TOTSQFT_EN, BTUEL)</span>
<span id="cb175-4"><a href="c05-descriptive-analysis.html#cb175-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `dplyr::summarise()`.
## ℹ In argument: `SQFT_Elec_Corr = survey_corr(TOTSQFT_EN, BTUEL)`.
## Caused by warning in `sweep()`:
## ! length(STATS) or dim(STATS) do not match dim(x)[MARGIN]</code></pre>
<pre><code>## # A tibble: 1 × 2
##   SQFT_Elec_Corr SQFT_Elec_Corr_se
##            &lt;dbl&gt;             &lt;dbl&gt;
## 1          0.367            0.0172</code></pre>
<p>Like with other statistics, we can do this by another variable. For example, we can examine the correlation by whether air-conditioning is used (<code>ACUsed</code>).</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="c05-descriptive-analysis.html#cb178-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb178-2"><a href="c05-descriptive-analysis.html#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ACUsed) <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="c05-descriptive-analysis.html#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb178-4"><a href="c05-descriptive-analysis.html#cb178-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">SQFT_Elec_Corr=</span><span class="fu">survey_corr</span>(TOTSQFT_EN, DOLLAREL)</span>
<span id="cb178-5"><a href="c05-descriptive-analysis.html#cb178-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: There were 2 warnings in `dplyr::summarise()`.
## The first warning was:
## ℹ In argument: `SQFT_Elec_Corr = survey_corr(TOTSQFT_EN, DOLLAREL)`.
## ℹ In group 1: `ACUsed = FALSE`.
## Caused by warning in `sweep()`:
## ! length(STATS) or dim(STATS) do not match dim(x)[MARGIN]
## ℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</code></pre>
<pre><code>## # A tibble: 2 × 3
##   ACUsed SQFT_Elec_Corr SQFT_Elec_Corr_se
##   &lt;lgl&gt;           &lt;dbl&gt;             &lt;dbl&gt;
## 1 FALSE           0.327            0.0468
## 2 TRUE            0.384            0.0189</code></pre>
</div>
</div>
<div id="ratios" class="section level3 hasAnchor" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Ratios<a href="c05-descriptive-analysis.html#ratios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ratio estimate is one many are not as familiar with. The ratio is a measure of the ratio of the sum of two variables, specifically in the form of:</p>
<p><span class="math display">\[ \frac{\sum x_i}{\sum y_i}.\]</span>
The ratio is not the same as calculating the following:</p>
<p><span class="math display">\[ \frac{1}{N} \sum \frac{x_i}{y_i} \]</span>
which could be calculated with <code>survey_mean()</code> by creating a derived variable <span class="math inline">\(z=x/y\)</span> and then calculating the mean of <span class="math inline">\(z\)</span>.</p>
<p>Consider a survey of police agencies in the United States. We might want to estimate the ratio of female police officers to total police officers. This could be done with <code>survey_ratio(Female_Officers, Total_Officers)</code>. If instead, we used <code>survey_means(Female_Officers/Total_Officers)</code>, we would be estimating the average percentage of female officers across agencies which is a different quantity.</p>
<div id="syntax-8" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The syntax for <code>survey_corr()</code> is as follows:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="c05-descriptive-analysis.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survey_ratio</span>(</span>
<span id="cb181-2"><a href="c05-descriptive-analysis.html#cb181-2" aria-hidden="true" tabindex="-1"></a>  numerator,</span>
<span id="cb181-3"><a href="c05-descriptive-analysis.html#cb181-3" aria-hidden="true" tabindex="-1"></a>  denominator,</span>
<span id="cb181-4"><a href="c05-descriptive-analysis.html#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">FALSE</span>,</span>
<span id="cb181-5"><a href="c05-descriptive-analysis.html#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>),</span>
<span id="cb181-6"><a href="c05-descriptive-analysis.html#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb181-7"><a href="c05-descriptive-analysis.html#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">deff =</span> <span class="cn">FALSE</span>,</span>
<span id="cb181-8"><a href="c05-descriptive-analysis.html#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="cn">NULL</span></span>
<span id="cb181-9"><a href="c05-descriptive-analysis.html#cb181-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The arguments are:</p>
<ul>
<li><code>numerator</code>: The numerator of the ratio</li>
<li><code>denominator</code>: The denominator of the ratio</li>
<li><code>na.rm</code>: A logical value to indicate whether missing values should be dropped</li>
<li><code>vartype</code>: Report variability as one or more of: standard error (“se”, default), confidence interval (“ci”), variance (“var”) or coefficient of variation (“cv”).</li>
<li><code>level</code>: A single number or vector of numbers indicating the confidence level</li>
<li><code>deff</code>: A logical value to indicate whether the design effect should be returned</li>
<li><code>df</code>: (For vartype = “ci” only) A numeric value indicating the degrees of freedom for t-distribution</li>
</ul>
</div>
<div id="examples-8" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose we wanted to find the ratio of dollars spent on liquid propane per unit (in British thermal unit [Btu]) nationally. If we wanted to find the average cost to a household, we could use <code>survey_mean()</code> but to find the national unit rate, we can use ratio. In the following example, we will show both methods and discuss the interpretation of each:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="c05-descriptive-analysis.html#cb182-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="c05-descriptive-analysis.html#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb182-3"><a href="c05-descriptive-analysis.html#cb182-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">DOLLARLP_Tot=</span><span class="fu">survey_total</span>(DOLLARLP),</span>
<span id="cb182-4"><a href="c05-descriptive-analysis.html#cb182-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">BTULP_Tot=</span><span class="fu">survey_total</span>(BTULP),</span>
<span id="cb182-5"><a href="c05-descriptive-analysis.html#cb182-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">DOL_BTU_Rat=</span><span class="fu">survey_ratio</span>(DOLLARLP, BTULP),</span>
<span id="cb182-6"><a href="c05-descriptive-analysis.html#cb182-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">DOL_BTU_Avg=</span><span class="fu">survey_mean</span>(DOLLARLP<span class="sc">/</span>BTULP, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb182-7"><a href="c05-descriptive-analysis.html#cb182-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 8
##   DOLLARLP_Tot DOLLARLP_Tot_se     BTULP_Tot BTULP_Tot_se DOL_BTU_Rat
##          &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1  7759788903.      890352681. 360915832595. 44956961024.      0.0215
## # ℹ 3 more variables: DOL_BTU_Rat_se &lt;dbl&gt;, DOL_BTU_Avg &lt;dbl&gt;,
## #   DOL_BTU_Avg_se &lt;dbl&gt;</code></pre>
<p>In the output above, the ratio of the total spent on liquid propane to the total consumption was 0.0215 but the average rate was 0.0215. With a little calculation, it can be shown that the ratio is the ratio of the totals DOLLARLP_Tot/BTULP_Tot=7,759,788,903/360,915,832,595=0.0215. While the ratio could be calculated manually in this manner, the standard error requires usage of the <code>survey_ratio()</code> function. The average can be interpreted as the average rate a household pays.</p>
<p>As previously done, we can use <code>group_by()</code> to examine whether this rate varies by region.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="c05-descriptive-analysis.html#cb184-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="c05-descriptive-analysis.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="c05-descriptive-analysis.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb184-4"><a href="c05-descriptive-analysis.html#cb184-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">DOL_BTU_Rat=</span><span class="fu">survey_ratio</span>(DOLLARLP, BTULP),</span>
<span id="cb184-5"><a href="c05-descriptive-analysis.html#cb184-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   Region    DOL_BTU_Rat DOL_BTU_Rat_se
##   &lt;fct&gt;           &lt;dbl&gt;          &lt;dbl&gt;
## 1 Northeast      0.0263       0.000888
## 2 Midwest        0.0167       0.000371
## 3 South          0.0218       0.000986
## 4 West           0.0232       0.000912</code></pre>
<p>Though not a statistical test, it does appear the cost rates in the Midwest for liquid propane are the lowest.</p>
</div>
</div>
</div>
<div id="additional-topics" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Additional topics<a href="c05-descriptive-analysis.html#additional-topics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="subpopulation-analysis" class="section level3 hasAnchor" number="5.8.1">
<h3><span class="header-section-number">5.8.1</span> Subpopulation analysis<a href="c05-descriptive-analysis.html#subpopulation-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Briefly, we mentioned using <code>filter()</code> to subset a survey object for analysis. This operation should be done after creating the design object. In rare circumstances, subsetting data before creating the object can lead to incorrect variability estimates. This can occur if subsetting removes an entire PSU.</p>
<p>Suppose, we wanted estimates of the average amount spent on natural gas among housing units that use natural gas. This could be obtained by first filtering records to only include records where <code>BTUNG&gt;0</code> and then finding the average amount of money spent.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="c05-descriptive-analysis.html#cb186-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb186-2"><a href="c05-descriptive-analysis.html#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(BTUNG<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb186-3"><a href="c05-descriptive-analysis.html#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb186-4"><a href="c05-descriptive-analysis.html#cb186-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">NG_mean=</span><span class="fu">survey_mean</span>(DOLLARNG, <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>))</span>
<span id="cb186-5"><a href="c05-descriptive-analysis.html#cb186-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   NG_mean NG_mean_se NG_mean_low NG_mean_upp
##     &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1    601.       9.49        582.        620.</code></pre>
<p>Note that this yields a higher mean than when not applying the filter. When including housing units that do not use natural gas, many $0 amounts are included in the mean calculation.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="c05-descriptive-analysis.html#cb188-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb188-2"><a href="c05-descriptive-analysis.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb188-3"><a href="c05-descriptive-analysis.html#cb188-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">NG_mean=</span><span class="fu">survey_mean</span>(DOLLARNG, <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>))</span>
<span id="cb188-4"><a href="c05-descriptive-analysis.html#cb188-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   NG_mean NG_mean_se NG_mean_low NG_mean_upp
##     &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1    349.       9.04        331.        367.</code></pre>
</div>
<div id="Var-types" class="section level3 hasAnchor" number="5.8.2">
<h3><span class="header-section-number">5.8.2</span> Variability types<a href="c05-descriptive-analysis.html#Var-types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In all of the functions discussed above (except <code>survey_sd()</code>), measures of variability can be calculated. The default variability measure is the standard error (<code>se</code>). There are 4 types of variability measures that can be calculated which are:</p>
<ul>
<li><code>se</code>: standard error
<ul>
<li>The estimated standard deviation of the estimate</li>
<li>Output has a column with the variable name specified in <code>summarize()</code> with a suffix of “_se”</li>
</ul></li>
<li><code>ci</code>: confidence interval
<ul>
<li>The lower and upper limits of a confidence interval</li>
<li>Output has a column with the variable name specified in <code>summarize()</code> with a suffix of “_low” and “_upp”</li>
<li>By default, this is a 95% confidence interval but can be changed by using the argument level and specifying a number between 0 and 1. For example, <code>level=0.8</code> would produce a 80% confidence interval</li>
</ul></li>
<li><code>var</code>: variance
<ul>
<li>The estimated variance of the estimate</li>
<li>Output has a column with the variable name specified in <code>summarize()</code> with a suffix of “_var”</li>
</ul></li>
<li><code>cv</code>: coefficient of variation
<ul>
<li>A ratio of the standard error and the estimate</li>
<li>Output has a column with the variable name specified in <code>summarize()</code> with a suffix of “_cv”</li>
<li>Not an option available for <code>survey_var()</code></li>
</ul></li>
</ul>
<p>We will return to the example of calculating the average electricity bill but include all the variability type options. Multiple options can be used at once.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="c05-descriptive-analysis.html#cb190-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb190-2"><a href="c05-descriptive-analysis.html#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">elec_bill =</span> <span class="fu">survey_mean</span>(DOLLAREL, <span class="at">vartype=</span><span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;cv&quot;</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   elec_bill elec_bill_se elec_bill_low elec_bill_upp elec_bill_var
##       &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
## 1     1375.         14.1         1347.         1403.          199.
## # ℹ 1 more variable: elec_bill_cv &lt;dbl&gt;</code></pre>
<p>It is also possible to not return any variability estimate by specifying <code>vartype</code> as <code>NULL</code>.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="c05-descriptive-analysis.html#cb192-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb192-2"><a href="c05-descriptive-analysis.html#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">elec_bill =</span> <span class="fu">survey_mean</span>(DOLLAREL, <span class="at">vartype=</span><span class="cn">NULL</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   elec_bill
##       &lt;dbl&gt;
## 1     1375.</code></pre>
<p>In the example below, an 80% confidence interval rather than the deafult 95% confidence interval is calculated</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="c05-descriptive-analysis.html#cb194-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb194-2"><a href="c05-descriptive-analysis.html#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">elec_bill =</span> <span class="fu">survey_mean</span>(DOLLAREL, <span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">level=</span><span class="fl">0.8</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   elec_bill elec_bill_low elec_bill_upp
##       &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
## 1     1375.         1356.         1393.</code></pre>
<p>For means, counts, totals, ratios, correlations, and variances, the confidence intervals are always calculated using a symmetric t-distribution based confidence interval as follows:</p>
<p><span class="math display">\[ \text{estimate} \pm t^*_{df}\times SE\]</span>
where <span class="math inline">\(t^*_{df}\)</span> is the critical value from a t-distribution based on the confidence level and the degrees of freedom. By default the degrees of freedom are calculated based off of the design or number of replicates but they can be specified using the argument <code>df</code>. For survey design objects, the degrees of freedom are calculated as the number of PSUs minus the number of strata. For replicate based objects, the degrees of freedom are calculated as one less than the rank of the matrix of replicate weight where the number of replicates is typically the rank. Note that specifying <code>df=Inf</code> is equivalent to using a normal (z-based) confidence interval. There are more options for calculating confidence intervals for proportions and quantiles (including medians) which are further described.</p>
<div id="confidence-intervals-for-proportions" class="section level4 unnumbered hasAnchor">
<h4>Confidence intervals for proportions<a href="c05-descriptive-analysis.html#confidence-intervals-for-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The interval above is referred to as a Wald-type interval. While a Wald-type interval using a symmetric t-based confidence interval is an option, this does not generally have the correct coverage rate when sample sizes are small and/or the proportion is “near” 0 or 1. Thus, other methods have been developed to calculate confidence intervals and can be specified using the <code>prop_method</code> option in <code>survey_prop()</code>. The options include:</p>
<ul>
<li><code>logit</code>: fits a logistic regression model and computes a Wald-type interval on the log-odds scale which is then transformed to the probability scale. This is the default method.</li>
<li><code>likelihood</code>: uses the (Rao-Scott) scaled chi-squared distribution for the log-likelihood from a binomial distribution.</li>
<li><code>asin</code>: uses the variance-stabilizing transformation for the binomial distribution, the arcsine square root, and then back-transforms the interval to the probability scale</li>
<li><code>beta</code>: uses the incomplete beta function with an effective sample size based on the estimated variance of the proportion.</li>
<li><code>mean</code>: the Wald-type interval</li>
<li><code>xlogit</code>: uses a logit transformation of the proportion, calculates a Wald-type interval, and then back-transforms to the probability scale. This method is implemented in SUDAAN and SPSS.</li>
</ul>
<p>In the example below, a logical derived variable is created for whether someone voted for a candidate that was neither Trump nor Biden in the 2020 presidential election. Then, a confidence interval is calculated for that proportion using the various methods.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="c05-descriptive-analysis.html#cb196-1" aria-hidden="true" tabindex="-1"></a>anes_des_sel <span class="ot">&lt;-</span> anes_des  <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="c05-descriptive-analysis.html#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VoteOther=</span>(VotedPres2020_selection<span class="sc">==</span><span class="st">&quot;Other&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb196-3"><a href="c05-descriptive-analysis.html#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(VoteOther)</span>
<span id="cb196-4"><a href="c05-descriptive-analysis.html#cb196-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-5"><a href="c05-descriptive-analysis.html#cb196-5" aria-hidden="true" tabindex="-1"></a>ci_p_vototh <span class="ot">&lt;-</span> </span>
<span id="cb196-6"><a href="c05-descriptive-analysis.html#cb196-6" aria-hidden="true" tabindex="-1"></a>  anes_des_sel <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(</span>
<span id="cb196-7"><a href="c05-descriptive-analysis.html#cb196-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_logit=</span><span class="fu">survey_prop</span>(<span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">prop_method=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb196-8"><a href="c05-descriptive-analysis.html#cb196-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_like=</span><span class="fu">survey_prop</span>(<span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">prop_method=</span><span class="st">&quot;likelihood&quot;</span>),</span>
<span id="cb196-9"><a href="c05-descriptive-analysis.html#cb196-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_asin=</span><span class="fu">survey_prop</span>(<span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">prop_method=</span><span class="st">&quot;asin&quot;</span>),</span>
<span id="cb196-10"><a href="c05-descriptive-analysis.html#cb196-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_beta=</span><span class="fu">survey_prop</span>(<span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">prop_method=</span><span class="st">&quot;beta&quot;</span>),</span>
<span id="cb196-11"><a href="c05-descriptive-analysis.html#cb196-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_mean=</span><span class="fu">survey_prop</span>(<span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">prop_method=</span><span class="st">&quot;mean&quot;</span>),</span>
<span id="cb196-12"><a href="c05-descriptive-analysis.html#cb196-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_xlogit=</span><span class="fu">survey_prop</span>(<span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">prop_method=</span><span class="st">&quot;xlogit&quot;</span>)</span>
<span id="cb196-13"><a href="c05-descriptive-analysis.html#cb196-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(VoteOther) </span>
<span id="cb196-14"><a href="c05-descriptive-analysis.html#cb196-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-15"><a href="c05-descriptive-analysis.html#cb196-15" aria-hidden="true" tabindex="-1"></a>ci_p_vototh <span class="sc">%&gt;%</span></span>
<span id="cb196-16"><a href="c05-descriptive-analysis.html#cb196-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;low&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   p_logit_low p_like_low p_asin_low p_beta_low p_mean_low p_xlogit_low
##         &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
## 1      0.0144     0.0143     0.0142     0.0142     0.0139       0.0144</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="c05-descriptive-analysis.html#cb198-1" aria-hidden="true" tabindex="-1"></a>ci_p_vototh <span class="sc">%&gt;%</span></span>
<span id="cb198-2"><a href="c05-descriptive-analysis.html#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;upp&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   p_logit_upp p_like_upp p_asin_upp p_beta_upp p_mean_upp p_xlogit_upp
##         &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
## 1      0.0230     0.0228     0.0227     0.0230     0.0224       0.0230</code></pre>
</div>
<div id="confidence-intervals-for-quantiles" class="section level4 unnumbered hasAnchor">
<h4>Confidence intervals for quantiles<a href="c05-descriptive-analysis.html#confidence-intervals-for-quantiles" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Like confidence intervals for proportions, there are several methods for calculating confidence intervals of quantiles which includes medians. The methods for interval types are many of the same as those for proportions (asin, beta, mean, and xlogit) with the addition of two more methods including:</p>
<ul>
<li><code>score</code>: the Francisco &amp; Fuller confidence interval based on inverting a score test (only available for design-based survey objects and not replicate based objects)</li>
<li><code>quantile</code>: based on the replicates of the quantile. Not valid for jackknife-type replicates but available for bootstrap and BRR replicates.</li>
</ul>
<p>In the example below the confidence interval for the 95<sup>th</sup> percentile of electricity expenditure is calculated using the various methods.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="c05-descriptive-analysis.html#cb200-1" aria-hidden="true" tabindex="-1"></a>ci_elbill_p90 <span class="ot">&lt;-</span> recs_des <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(</span>
<span id="cb200-2"><a href="c05-descriptive-analysis.html#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">p90_asin=</span><span class="fu">survey_quantile</span>(DOLLAREL, .<span class="dv">9</span>, <span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">interval_type =</span> <span class="st">&quot;asin&quot;</span>),</span>
<span id="cb200-3"><a href="c05-descriptive-analysis.html#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p90_beta=</span><span class="fu">survey_quantile</span>(DOLLAREL, .<span class="dv">9</span>, <span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">interval_type =</span> <span class="st">&quot;beta&quot;</span>),</span>
<span id="cb200-4"><a href="c05-descriptive-analysis.html#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p90_mean=</span><span class="fu">survey_quantile</span>(DOLLAREL, .<span class="dv">9</span>, <span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">interval_type =</span> <span class="st">&quot;mean&quot;</span>),</span>
<span id="cb200-5"><a href="c05-descriptive-analysis.html#cb200-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">p90_xlog=</span><span class="fu">survey_quantile</span>(DOLLAREL, .<span class="dv">9</span>, <span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">interval_type =</span> <span class="st">&quot;xlogit&quot;</span>),</span>
<span id="cb200-6"><a href="c05-descriptive-analysis.html#cb200-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">p90_quant=</span><span class="fu">survey_quantile</span>(DOLLAREL, .<span class="dv">9</span>, <span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">interval_type =</span> <span class="st">&quot;quantile&quot;</span>)</span>
<span id="cb200-7"><a href="c05-descriptive-analysis.html#cb200-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb200-8"><a href="c05-descriptive-analysis.html#cb200-8" aria-hidden="true" tabindex="-1"></a>ci_elbill_p90 <span class="sc">%&gt;%</span></span>
<span id="cb200-9"><a href="c05-descriptive-analysis.html#cb200-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;low&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   p90_asin_q90_low p90_beta_q90_low p90_mean_q90_low p90_xlog_q90_low
##              &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
## 1            2331.            2327.            2336.            2327.
## # ℹ 1 more variable: p90_quant_q90_low &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="c05-descriptive-analysis.html#cb202-1" aria-hidden="true" tabindex="-1"></a>ci_elbill_p90 <span class="sc">%&gt;%</span></span>
<span id="cb202-2"><a href="c05-descriptive-analysis.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;upp&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   p90_asin_q90_upp p90_beta_q90_upp p90_mean_q90_upp p90_xlog_q90_upp
##              &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
## 1             2470             2470            2473.            2469.
## # ℹ 1 more variable: p90_quant_q90_upp &lt;dbl&gt;</code></pre>
<p>In the example below, the mean and score type confidence interval are calculated for the median age of the voting age population.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="c05-descriptive-analysis.html#cb204-1" aria-hidden="true" tabindex="-1"></a>anes_des <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(</span>
<span id="cb204-2"><a href="c05-descriptive-analysis.html#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">am=</span><span class="fu">survey_median</span>(Age, <span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">interval_type=</span><span class="st">&quot;mean&quot;</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb204-3"><a href="c05-descriptive-analysis.html#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">as=</span><span class="fu">survey_median</span>(Age, <span class="at">vartype=</span><span class="st">&quot;ci&quot;</span>, <span class="at">interval_type=</span><span class="st">&quot;score&quot;</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb204-4"><a href="c05-descriptive-analysis.html#cb204-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##      am am_low am_upp    as as_low as_upp
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1    47     46     49    47     40     42</code></pre>
<p>Note that in instances when there are many ties in the data, the score method can produce confidence intervals that do not contain the estimate as is shown above. The documentation in the {survey} package indicates this method has lower performance than the beta and logit intervals. This is the method implemented in SUDAAN though SUDAAN now adds noise to the values to prevent the issue with the ties.</p>
</div>
</div>
<div id="design-effects" class="section level3 hasAnchor" number="5.8.3">
<h3><span class="header-section-number">5.8.3</span> Design effects<a href="c05-descriptive-analysis.html#design-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The design effect measures how the precision of an estimate is impacted by the sampling design. A design effect is calculated as the ratio of the variance of an estimate under the design at hand to the variance of the estimate under a simple random sample without replacement (SRS). A design effect less than 1 indicates that the design is <em>more</em> statisticially efficient than a SRS design. This is rare but possible in a stratified sampling design where the outcome is correlated with the stratification variable(s). A design effect greater than 1 indicates that the design is <em>less</em> statistically effecient than a SRS design. From a design effect, we can calculate the effective sample size as follows:</p>
<p><span class="math display">\[n_{eff}=\frac{n}{D_{eff}} \]</span></p>
<p>where <span class="math inline">\(n\)</span> is the nominal sample size (number of survey responses) and <span class="math inline">\(D_{eff}\)</span> is the estimated design effect. The effective sample size has an interesting interpretation that a survey using a SRS design would need a sample size of <span class="math inline">\(n_{eff}\)</span> to obtain the same precision as the design at hand which is where the efficiency interpretation comes in. Design effects are outcome specific - outcomes that are less clustered in the population have smaller design effects than outcomes which are clustered.</p>
<p>In the {srvyr} package, design effects can be calculated for totals, proportions, means, and ratio estimates by setting the <code>deff</code> argument to TRUE in the corresponding functions.</p>
<div id="example-9" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="c05-descriptive-analysis.html#example-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the example below, the design effect is calculated for the means the consumption of electricity (BTUEL), natural gas (BTUNG), liquid propane (BTULP), fuel oil (BTUFO), wood (BTUWOOD), and wood pellets (BTUPELLET).</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="c05-descriptive-analysis.html#cb206-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb206-2"><a href="c05-descriptive-analysis.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb206-3"><a href="c05-descriptive-analysis.html#cb206-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(BTUEL, BTUNG, BTULP, BTUFO, BTUWOOD, BTUPELLET),</span>
<span id="cb206-4"><a href="c05-descriptive-analysis.html#cb206-4" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">survey_mean</span>(.x, <span class="at">deff=</span><span class="cn">TRUE</span>, <span class="at">vartype=</span><span class="cn">NULL</span>))</span>
<span id="cb206-5"><a href="c05-descriptive-analysis.html#cb206-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb206-6"><a href="c05-descriptive-analysis.html#cb206-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;deff&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   BTUEL_deff BTUNG_deff BTULP_deff BTUFO_deff BTUWOOD_deff
##        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
## 1       1.59       2.39       4.37       1.75         2.17
## # ℹ 1 more variable: BTUPELLET_deff &lt;dbl&gt;</code></pre>
</div>
</div>
<div id="creating-summary-rows" class="section level3 hasAnchor" number="5.8.4">
<h3><span class="header-section-number">5.8.4</span> Creating summary rows<a href="c05-descriptive-analysis.html#creating-summary-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When using <code>group_by()</code> in analysis, results are returned with a row for each group or group combination. Often, we want a summary row for the estimate for the entire population. For example, we may want the average electricity consumption by region AND nationally. The {srvyr} package has a function <code>cascade()</code> which adds summary rows for the total of a group. It is used in place of summarize and has some additional features.</p>
<div id="syntax-9" class="section level4 unnumbered hasAnchor">
<h4>Syntax<a href="c05-descriptive-analysis.html#syntax-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The syntax is as follows:</p>
<pre><code>cascade(
  .data, 
  ..., 
  .fill = NA, 
  .fill_level_top = FALSE, 
  .groupings = NULL
)</code></pre>
<p>where the arguments are:</p>
<ul>
<li><code>.data</code>: A <code>tbl_svy</code> object</li>
<li><code>...</code>: Name-value pairs of summary functions</li>
<li><code>.fill</code>: Value to fill in for group summaries (defaults to <code>NA</code>)</li>
<li><code>.fill_level_top</code>: When filling factor variables, whether to put the value ‘.fill’ in the first position (defaults to FALSE, placing it in the bottom).</li>
<li><code>.groupings</code>: (Experimental) A list of lists of quosures to manually specify the groupings to use, rather than the default.</li>
</ul>
</div>
<div id="examples-9" class="section level4 unnumbered hasAnchor">
<h4>Examples<a href="c05-descriptive-analysis.html#examples-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, let’s take a look at a simple example and then build on it to examine the features of the function. In the first example, all default values are used.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="c05-descriptive-analysis.html#cb209-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb209-2"><a href="c05-descriptive-analysis.html#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb209-3"><a href="c05-descriptive-analysis.html#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cascade</span>(<span class="at">DOLLAREL_mn=</span><span class="fu">survey_mean</span>(DOLLAREL))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   Region    DOLLAREL_mn DOLLAREL_mn_se
##   &lt;fct&gt;           &lt;dbl&gt;          &lt;dbl&gt;
## 1 Northeast       1346.           34.2
## 2 Midwest         1196.           20.2
## 3 South           1631.           25.3
## 4 West            1146.           32.3
## 5 &lt;NA&gt;            1375.           14.1</code></pre>
<p>The last row where <code>Region=NA</code> is the national average electricity bill. We might wish to have a better name for it and can do that using the <code>.fill</code> argument.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="c05-descriptive-analysis.html#cb211-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb211-2"><a href="c05-descriptive-analysis.html#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb211-3"><a href="c05-descriptive-analysis.html#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cascade</span>(<span class="at">DOLLAREL_mn=</span><span class="fu">survey_mean</span>(DOLLAREL),</span>
<span id="cb211-4"><a href="c05-descriptive-analysis.html#cb211-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">.fill=</span><span class="st">&quot;National&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   Region    DOLLAREL_mn DOLLAREL_mn_se
##   &lt;fct&gt;           &lt;dbl&gt;          &lt;dbl&gt;
## 1 Northeast       1346.           34.2
## 2 Midwest         1196.           20.2
## 3 South           1631.           25.3
## 4 West            1146.           32.3
## 5 National        1375.           14.1</code></pre>
<p>We can also have more than one grouping variable as follows:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="c05-descriptive-analysis.html#cb213-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb213-2"><a href="c05-descriptive-analysis.html#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, Urbanicity) <span class="sc">%&gt;%</span></span>
<span id="cb213-3"><a href="c05-descriptive-analysis.html#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cascade</span>(<span class="at">DOLLAREL_mn=</span><span class="fu">survey_mean</span>(DOLLAREL), <span class="at">.fill=</span><span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb213-4"><a href="c05-descriptive-analysis.html#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 17 × 4
##    Region    Urbanicity    DOLLAREL_mn DOLLAREL_mn_se
##    &lt;fct&gt;     &lt;fct&gt;               &lt;dbl&gt;          &lt;dbl&gt;
##  1 Northeast Urban Area          1350.           30.8
##  2 Northeast Urban Cluster       1123.          113. 
##  3 Northeast Rural               1473.           68.6
##  4 Northeast Total               1346.           34.2
##  5 Midwest   Urban Area          1062.           28.6
##  6 Midwest   Urban Cluster       1163.           64.3
##  7 Midwest   Rural               1623.           54.0
##  8 Midwest   Total               1196.           20.2
##  9 South     Urban Area          1581.           34.3
## 10 South     Urban Cluster       1377.           59.7
## 11 South     Rural               1879.           65.8
## 12 South     Total               1631.           25.3
## 13 West      Urban Area          1110.           34.6
## 14 West      Urban Cluster       1134.           69.7
## 15 West      Rural               1363.           83.0
## 16 West      Total               1146.           32.3
## 17 Total     Total               1375.           14.1</code></pre>
<p>We can move the summary row to being the first row:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="c05-descriptive-analysis.html#cb215-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb215-2"><a href="c05-descriptive-analysis.html#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb215-3"><a href="c05-descriptive-analysis.html#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cascade</span>(<span class="at">DOLLAREL_mn=</span><span class="fu">survey_mean</span>(DOLLAREL), <span class="at">.fill=</span><span class="st">&quot;National&quot;</span>, <span class="at">.fill_level_top =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb215-4"><a href="c05-descriptive-analysis.html#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   Region    DOLLAREL_mn DOLLAREL_mn_se
##   &lt;fct&gt;           &lt;dbl&gt;          &lt;dbl&gt;
## 1 National        1375.           14.1
## 2 Northeast       1346.           34.2
## 3 Midwest         1196.           20.2
## 4 South           1631.           25.3
## 5 West            1146.           32.3</code></pre>
</div>
</div>
<div id="calculating-estimates-for-many-outcomes" class="section level3 hasAnchor" number="5.8.5">
<h3><span class="header-section-number">5.8.5</span> Calculating estimates for many outcomes<a href="c05-descriptive-analysis.html#calculating-estimates-for-many-outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often, we are interested in a summary statistic across many variables. Two useful tools in doing this are the <code>across()</code> function in {dplyr} which has been shown a few times above and the <code>map()</code> function in {purrr}.</p>
<p>The <code>across()</code> function allows you to apply the same function to several columns within <code>summarize()</code>. This works well for usage with all functions shown above except <code>survey_prop()</code>. In a later example, we will tackle several proportions.</p>
<div id="across-example-1" class="section level4 unnumbered hasAnchor">
<h4>across() Example 1<a href="c05-descriptive-analysis.html#across-example-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose, we want to calculate the total consumption for each fuel type and the average consumption for each fuel type with coefficients of variation. These include the consumption of electricity (BTUEL), natural gas (BTUNG), liquid propane (BTULP), fuel oil (BTUFO), wood (BTUWOOD), and wood pellets (BTUPELLET) as illustrated in the discussion on design effects. These are the only variables that start with “BTU” so we can use that to our advantage.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="c05-descriptive-analysis.html#cb217-1" aria-hidden="true" tabindex="-1"></a>consumption_ests <span class="ot">&lt;-</span> recs_des <span class="sc">%&gt;%</span></span>
<span id="cb217-2"><a href="c05-descriptive-analysis.html#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb217-3"><a href="c05-descriptive-analysis.html#cb217-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;BTU&quot;</span>), </span>
<span id="cb217-4"><a href="c05-descriptive-analysis.html#cb217-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">list</span>(<span class="at">tot=</span><span class="sc">~</span><span class="fu">survey_total</span>(.x, <span class="at">vartype=</span><span class="st">&quot;cv&quot;</span>), <span class="at">mn=</span><span class="sc">~</span><span class="fu">survey_mean</span>(.x, <span class="at">vartype=</span><span class="st">&quot;cv&quot;</span>)))</span>
<span id="cb217-5"><a href="c05-descriptive-analysis.html#cb217-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb217-6"><a href="c05-descriptive-analysis.html#cb217-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-7"><a href="c05-descriptive-analysis.html#cb217-7" aria-hidden="true" tabindex="-1"></a>consumption_ests</span></code></pre></div>
<pre><code>## # A tibble: 1 × 24
##   BTUEL_tot BTUEL_tot_cv BTUEL_mn BTUEL_mn_cv BTUNG_tot BTUNG_tot_cv
##       &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
## 1   4.32e12       0.0108   36578.      0.0108   3.96e12       0.0255
## # ℹ 18 more variables: BTUNG_mn &lt;dbl&gt;, BTUNG_mn_cv &lt;dbl&gt;,
## #   BTULP_tot &lt;dbl&gt;, BTULP_tot_cv &lt;dbl&gt;, BTULP_mn &lt;dbl&gt;,
## #   BTULP_mn_cv &lt;dbl&gt;, BTUFO_tot &lt;dbl&gt;, BTUFO_tot_cv &lt;dbl&gt;,
## #   BTUFO_mn &lt;dbl&gt;, BTUFO_mn_cv &lt;dbl&gt;, BTUWOOD_tot &lt;dbl&gt;,
## #   BTUWOOD_tot_cv &lt;dbl&gt;, BTUWOOD_mn &lt;dbl&gt;, BTUWOOD_mn_cv &lt;dbl&gt;,
## #   BTUPELLET_tot &lt;dbl&gt;, BTUPELLET_tot_cv &lt;dbl&gt;, BTUPELLET_mn &lt;dbl&gt;,
## #   BTUPELLET_mn_cv &lt;dbl&gt;</code></pre>
<p>In the example above, this results in a very wide table. We may instead want a row for each fuel type. Using the <code>pivot_longer()</code>, <code>separate_wider_delim()</code>, and <code>pivot_wider()</code> functions from {tidyr} can help us get there. We will first make the data much longer. First we make the table longer:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="c05-descriptive-analysis.html#cb219-1" aria-hidden="true" tabindex="-1"></a>consumption_ests_long <span class="ot">&lt;-</span> consumption_ests <span class="sc">%&gt;%</span></span>
<span id="cb219-2"><a href="c05-descriptive-analysis.html#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>())</span>
<span id="cb219-3"><a href="c05-descriptive-analysis.html#cb219-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-4"><a href="c05-descriptive-analysis.html#cb219-4" aria-hidden="true" tabindex="-1"></a>consumption_ests_long</span></code></pre></div>
<pre><code>## # A tibble: 24 × 2
##    name            value
##    &lt;chr&gt;           &lt;dbl&gt;
##  1 BTUEL_tot    4.32e+12
##  2 BTUEL_tot_cv 1.08e- 2
##  3 BTUEL_mn     3.66e+ 4
##  4 BTUEL_mn_cv  1.08e- 2
##  5 BTUNG_tot    3.96e+12
##  6 BTUNG_tot_cv 2.55e- 2
##  7 BTUNG_mn     3.35e+ 4
##  8 BTUNG_mn_cv  2.55e- 2
##  9 BTULP_tot    3.61e+11
## 10 BTULP_tot_cv 1.25e- 1
## # ℹ 14 more rows</code></pre>
<p>Then we separate out the name column to separate columns for naming later:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="c05-descriptive-analysis.html#cb221-1" aria-hidden="true" tabindex="-1"></a>consumption_ests_sep <span class="ot">&lt;-</span> consumption_ests_long <span class="sc">%&gt;%</span></span>
<span id="cb221-2"><a href="c05-descriptive-analysis.html#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(name, </span>
<span id="cb221-3"><a href="c05-descriptive-analysis.html#cb221-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;FuelType&quot;</span>, <span class="st">&quot;EstType&quot;</span>, <span class="st">&quot;EstType2&quot;</span>), </span>
<span id="cb221-4"><a href="c05-descriptive-analysis.html#cb221-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim=</span><span class="st">&quot;_&quot;</span>, </span>
<span id="cb221-5"><a href="c05-descriptive-analysis.html#cb221-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span>)</span>
<span id="cb221-6"><a href="c05-descriptive-analysis.html#cb221-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-7"><a href="c05-descriptive-analysis.html#cb221-7" aria-hidden="true" tabindex="-1"></a>consumption_ests_sep</span></code></pre></div>
<pre><code>## # A tibble: 24 × 4
##    FuelType EstType EstType2    value
##    &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;
##  1 BTUEL    tot     &lt;NA&gt;     4.32e+12
##  2 BTUEL    tot     cv       1.08e- 2
##  3 BTUEL    mn      &lt;NA&gt;     3.66e+ 4
##  4 BTUEL    mn      cv       1.08e- 2
##  5 BTUNG    tot     &lt;NA&gt;     3.96e+12
##  6 BTUNG    tot     cv       2.55e- 2
##  7 BTUNG    mn      &lt;NA&gt;     3.35e+ 4
##  8 BTUNG    mn      cv       2.55e- 2
##  9 BTULP    tot     &lt;NA&gt;     3.61e+11
## 10 BTULP    tot     cv       1.25e- 1
## # ℹ 14 more rows</code></pre>
<p>Then we create what will become column names and pivot wider to create a table that is almost ready for a publication. A bit more on that will be covered in Chapter <a href="c08-communicating-results.html#c08-communicating-results">8</a>.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="c05-descriptive-analysis.html#cb223-1" aria-hidden="true" tabindex="-1"></a>consumption_ests_sep <span class="sc">%&gt;%</span></span>
<span id="cb223-2"><a href="c05-descriptive-analysis.html#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColName=</span><span class="fu">case_when</span>(</span>
<span id="cb223-3"><a href="c05-descriptive-analysis.html#cb223-3" aria-hidden="true" tabindex="-1"></a>    EstType<span class="sc">==</span><span class="st">&quot;tot&quot;</span><span class="sc">&amp;</span><span class="fu">is.na</span>(EstType2)<span class="sc">~</span><span class="st">&quot;Total&quot;</span>,</span>
<span id="cb223-4"><a href="c05-descriptive-analysis.html#cb223-4" aria-hidden="true" tabindex="-1"></a>    EstType<span class="sc">==</span><span class="st">&quot;tot&quot;</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(EstType2)<span class="sc">~</span><span class="st">&quot;Total (CV)&quot;</span>,</span>
<span id="cb223-5"><a href="c05-descriptive-analysis.html#cb223-5" aria-hidden="true" tabindex="-1"></a>    EstType<span class="sc">==</span><span class="st">&quot;mn&quot;</span><span class="sc">&amp;</span><span class="fu">is.na</span>(EstType2)<span class="sc">~</span><span class="st">&quot;Mean&quot;</span>,</span>
<span id="cb223-6"><a href="c05-descriptive-analysis.html#cb223-6" aria-hidden="true" tabindex="-1"></a>    EstType<span class="sc">==</span><span class="st">&quot;mn&quot;</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(EstType2)<span class="sc">~</span><span class="st">&quot;Mean (CV)&quot;</span>,</span>
<span id="cb223-7"><a href="c05-descriptive-analysis.html#cb223-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb223-8"><a href="c05-descriptive-analysis.html#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span>FuelType, <span class="at">names_from=</span>ColName, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb223-9"><a href="c05-descriptive-analysis.html#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FuelType=</span><span class="fu">str_remove</span>(FuelType, <span class="st">&quot;BTU&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   FuelType   Total `Total (CV)`   Mean `Mean (CV)`
##   &lt;chr&gt;      &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;
## 1 EL       4.32e12       0.0108 36578.      0.0108
## 2 NG       3.96e12       0.0255 33541.      0.0255
## 3 LP       3.61e11       0.125   3053.      0.125 
## 4 FO       4.64e11       0.0853  3927.      0.0853
## 5 WOOD     4.92e11       0.0908  4159.      0.0908
## 6 PELLET   2.11e10       0.242    179.      0.242</code></pre>
</div>
<div id="across-example-2" class="section level4 unnumbered hasAnchor">
<h4>across() Example 2<a href="c05-descriptive-analysis.html#across-example-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As mentioned earlier, proportions will not work as well directly with the across method. If you wanted the proportion of houses with air conditioning and the proportion of houses with heating, you might imagine needing two <code>group_by()</code> statements as follows:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="c05-descriptive-analysis.html#cb225-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb225-2"><a href="c05-descriptive-analysis.html#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ACUsed) <span class="sc">%&gt;%</span></span>
<span id="cb225-3"><a href="c05-descriptive-analysis.html#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p=</span><span class="fu">survey_prop</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   ACUsed     p    p_se
##   &lt;lgl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1 FALSE  0.130 0.00826
## 2 TRUE   0.870 0.00826</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="c05-descriptive-analysis.html#cb227-1" aria-hidden="true" tabindex="-1"></a>recs_des <span class="sc">%&gt;%</span></span>
<span id="cb227-2"><a href="c05-descriptive-analysis.html#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SpaceHeatingUsed) <span class="sc">%&gt;%</span></span>
<span id="cb227-3"><a href="c05-descriptive-analysis.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p=</span><span class="fu">survey_prop</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   SpaceHeatingUsed      p    p_se
##   &lt;lgl&gt;             &lt;dbl&gt;   &lt;dbl&gt;
## 1 FALSE            0.0435 0.00370
## 2 TRUE             0.957  0.00370</code></pre>
<p>If you are <em>only</em> interested in the <code>TRUE</code> outcomes, that is the proportion that do have air conditioning and the proportion that have heating, you can use the fact that <code>survey_mean()</code> applied to a logical variable is the same as using <code>survey_prop()</code> as is shown below:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="c05-descriptive-analysis.html#cb229-1" aria-hidden="true" tabindex="-1"></a>cool_heat_tab <span class="ot">&lt;-</span> recs_des <span class="sc">%&gt;%</span></span>
<span id="cb229-2"><a href="c05-descriptive-analysis.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(ACUsed, SpaceHeatingUsed), <span class="sc">~</span><span class="fu">survey_mean</span>(.x)))</span>
<span id="cb229-3"><a href="c05-descriptive-analysis.html#cb229-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-4"><a href="c05-descriptive-analysis.html#cb229-4" aria-hidden="true" tabindex="-1"></a>cool_heat_tab</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   ACUsed ACUsed_se SpaceHeatingUsed SpaceHeatingUsed_se
##    &lt;dbl&gt;     &lt;dbl&gt;            &lt;dbl&gt;               &lt;dbl&gt;
## 1  0.870   0.00826            0.957             0.00370</code></pre>
<p>Note the estimates are the same as when using the separate <code>group_by()</code> statements. Similar to previously done, we can use a combination of <code>pivot_longer()</code> and <code>pivot_wider()</code> to create a table in a format better suited for distribution.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="c05-descriptive-analysis.html#cb231-1" aria-hidden="true" tabindex="-1"></a>cool_heat_tab <span class="sc">%&gt;%</span></span>
<span id="cb231-2"><a href="c05-descriptive-analysis.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb231-3"><a href="c05-descriptive-analysis.html#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(name, <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;Comfort&quot;</span>, <span class="st">&quot;EstType&quot;</span>), <span class="at">delim=</span><span class="st">&quot;_&quot;</span>, <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb231-4"><a href="c05-descriptive-analysis.html#cb231-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EstType=</span><span class="fu">if_else</span>(<span class="fu">is.na</span>(EstType), <span class="st">&quot;p&quot;</span>, EstType)) <span class="sc">%&gt;%</span></span>
<span id="cb231-5"><a href="c05-descriptive-analysis.html#cb231-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>EstType, <span class="at">values_from=</span>value)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   Comfort              p      se
##   &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt;
## 1 ACUsed           0.870 0.00826
## 2 SpaceHeatingUsed 0.957 0.00370</code></pre>
</div>
<div id="map-example" class="section level4 unnumbered hasAnchor">
<h4>map example<a href="c05-descriptive-analysis.html#map-example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you want to calculate something again and again, loops are a common tool. The {purrr} package has the <code>map()</code> functions which like a loop allows you to do something in the same way many times. In our case, we want to calculate proportions from the same design multiple times. We find an easy way to do this is to think about how you would do it for one outcome, build a function from there, and then iterate.</p>
<p>Suppose, we want to create a table that shows the proportion of people that trust in their government (<code>TrustGovernment</code>)<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> as well as those that trust in people (<code>TrustPeople</code>)<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a>.</p>
<p>In the example below, we create a table that has the variable name as a column, the answer as a column, and then the percentage and its standard error.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="c05-descriptive-analysis.html#cb233-1" aria-hidden="true" tabindex="-1"></a>anes_des <span class="sc">%&gt;%</span></span>
<span id="cb233-2"><a href="c05-descriptive-analysis.html#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(TrustGovernment) <span class="sc">%&gt;%</span></span>
<span id="cb233-3"><a href="c05-descriptive-analysis.html#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TrustGovernment) <span class="sc">%&gt;%</span></span>
<span id="cb233-4"><a href="c05-descriptive-analysis.html#cb233-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p=</span><span class="fu">survey_prop</span>()<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb233-5"><a href="c05-descriptive-analysis.html#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Variable=</span><span class="st">&quot;TrustGovernment&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb233-6"><a href="c05-descriptive-analysis.html#cb233-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Answer=</span>TrustGovernment) <span class="sc">%&gt;%</span></span>
<span id="cb233-7"><a href="c05-descriptive-analysis.html#cb233-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variable, <span class="fu">everything</span>())</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   Variable        Answer                  p  p_se
##   &lt;chr&gt;           &lt;fct&gt;               &lt;dbl&gt; &lt;dbl&gt;
## 1 TrustGovernment Always               1.55 0.204
## 2 TrustGovernment Most of the time    13.2  0.553
## 3 TrustGovernment About half the time 30.9  0.829
## 4 TrustGovernment Some of the time    43.4  0.855
## 5 TrustGovernment Never               11.0  0.566</code></pre>
<p>To turn this into a function, we need to use a bit of tidy evaluation which is a more advanced skill. If you want to learn more, we recommend <span class="citation">Wickham (<a href="#ref-wickham2019advanced" role="doc-biblioref">2019</a>)</span>.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="c05-descriptive-analysis.html#cb235-1" aria-hidden="true" tabindex="-1"></a>calcps <span class="ot">&lt;-</span> <span class="cf">function</span>(var){</span>
<span id="cb235-2"><a href="c05-descriptive-analysis.html#cb235-2" aria-hidden="true" tabindex="-1"></a>  anes_des <span class="sc">%&gt;%</span></span>
<span id="cb235-3"><a href="c05-descriptive-analysis.html#cb235-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(<span class="sc">!!</span><span class="fu">sym</span>(var)) <span class="sc">%&gt;%</span></span>
<span id="cb235-4"><a href="c05-descriptive-analysis.html#cb235-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!</span><span class="fu">sym</span>(var)) <span class="sc">%&gt;%</span></span>
<span id="cb235-5"><a href="c05-descriptive-analysis.html#cb235-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">p=</span><span class="fu">survey_prop</span>()<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb235-6"><a href="c05-descriptive-analysis.html#cb235-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Variable=</span>var) <span class="sc">%&gt;%</span></span>
<span id="cb235-7"><a href="c05-descriptive-analysis.html#cb235-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Answer:=</span><span class="sc">!!</span><span class="fu">sym</span>(var)) <span class="sc">%&gt;%</span></span>
<span id="cb235-8"><a href="c05-descriptive-analysis.html#cb235-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Variable, <span class="fu">everything</span>())</span>
<span id="cb235-9"><a href="c05-descriptive-analysis.html#cb235-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb235-10"><a href="c05-descriptive-analysis.html#cb235-10" aria-hidden="true" tabindex="-1"></a><span class="fu">calcps</span>(<span class="st">&quot;TrustGovernment&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   Variable        Answer                  p  p_se
##   &lt;chr&gt;           &lt;fct&gt;               &lt;dbl&gt; &lt;dbl&gt;
## 1 TrustGovernment Always               1.55 0.204
## 2 TrustGovernment Most of the time    13.2  0.553
## 3 TrustGovernment About half the time 30.9  0.829
## 4 TrustGovernment Some of the time    43.4  0.855
## 5 TrustGovernment Never               11.0  0.566</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="c05-descriptive-analysis.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calcps</span>(<span class="st">&quot;TrustPeople&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   Variable    Answer                   p  p_se
##   &lt;chr&gt;       &lt;fct&gt;                &lt;dbl&gt; &lt;dbl&gt;
## 1 TrustPeople Always               0.809 0.164
## 2 TrustPeople Most of the time    41.4   0.857
## 3 TrustPeople About half the time 28.2   0.776
## 4 TrustPeople Some of the time    24.5   0.670
## 5 TrustPeople Never                5.05  0.422</code></pre>
<p>Now, we can use map to iterate over as many variables as we want. It will output a data.frame with the variable name in the column “Variable”, the responses in “Answer”, the percentage and then the standard error. Finally, we can now use map to do this iteratively. This example extends nicely if you have many variables for which you want the percentage estimate.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="c05-descriptive-analysis.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;TrustGovernment&quot;</span>, <span class="st">&quot;TrustPeople&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">map</span>(calcps) <span class="sc">%&gt;%</span> <span class="fu">list_rbind</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
##    Variable        Answer                   p  p_se
##    &lt;chr&gt;           &lt;fct&gt;                &lt;dbl&gt; &lt;dbl&gt;
##  1 TrustGovernment Always               1.55  0.204
##  2 TrustGovernment Most of the time    13.2   0.553
##  3 TrustGovernment About half the time 30.9   0.829
##  4 TrustGovernment Some of the time    43.4   0.855
##  5 TrustGovernment Never               11.0   0.566
##  6 TrustPeople     Always               0.809 0.164
##  7 TrustPeople     Most of the time    41.4   0.857
##  8 TrustPeople     About half the time 28.2   0.776
##  9 TrustPeople     Some of the time    24.5   0.670
## 10 TrustPeople     Never                5.05  0.422</code></pre>
</div>
</div>
</div>
<div id="exercises-1" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Exercises<a href="c05-descriptive-analysis.html#exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first set of exercises should use the design object <code>anes_des</code> created in the book earlier.</p>
<ol style="list-style-type: decimal">
<li><p>How many females have a graduate degree? Hint: the variables <code>Gender</code> and <code>Education</code> will be useful.</p></li>
<li><p>What percentage of people identify as “Strong Democrat”? Hint: The variable <code>PartyID</code> indicates what party people identify with.</p></li>
<li><p>What percentage of people who voted in the 2020 election identify as “Strong Republican”? Hint: The variable <code>VotedPres2020</code> indicates whether someone voted in 2020.</p></li>
<li><p>What percentage of people voted in both the 2016 election and in the 2020 election? Include the logit confidence interval. Hint: The variable <code>VotedPres2016</code> indicates whether someone voted in 2016.</p></li>
<li><p>What is the design effect for the proportion of people who voted early? Hint: The variable <code>EarlyVote2020</code> indicates whether someone voted early in 2020.</p></li>
<li><p>What is the average temperature that people set their thermostats to at night during the winter? Hint: The variable <code>WinterTempNight</code> indicates the temperature that people set their temperature in the winter at night.</p></li>
<li><p>People do not always set their temperature the same over different seasons and during the day. What are the median temperatures that people set their thermostat to in the summer and winter both during the day and during the night? Include confidence intervals. Hint: Use the variables <code>WinterTempDay</code>, <code>WinterTempNight</code>, <code>SummerTempDay</code>, and <code>SummerTempNight</code>.</p></li>
<li><p>What is the correlation between the temperature that people set their temperature at during the night and during the day in the summer?</p></li>
<li><p>What is the 1st, 2nd, and 3rd quartile of the amount of money spent on energy by Building America (BA) climate zone? Hint: <code>TOTALDOL</code> indicates the total amount spent on electricity and <code>ClimateRegion_BA</code> indicates the BA climate zones</p></li>
</ol>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-shahvaish" class="csl-entry">
Shah, Babubhai V, and Akhil K Vaish. 2006. <span>“Confidence Intervals for Quantile Estimation from Complex Survey Data.”</span> In <em>Proceedings of the Section on Survey Research Methods</em>.
</div>
<div id="ref-wickham2019advanced" class="csl-entry">
Wickham, Hadley. 2019. <em>Advanced <span>R</span></em>. CRC press. <a href="https://adv-r.hadley.nz/">https://adv-r.hadley.nz/</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>RECS has two components: a household survey and an energy supplier survey. For each household that responds, their energy provider(s) are contacted to obtain their energy consumption and expenditure. This value reflects the dollars spent on electricity in 2015 according to the energy supplier. See <a href="https://www.eia.gov/consumption/residential/reports/2015/methodology/pdf/2015C&amp;EMethodology.pdf" class="uri">https://www.eia.gov/consumption/residential/reports/2015/methodology/pdf/2015C&amp;EMethodology.pdf</a> for more details.<a href="c05-descriptive-analysis.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>Question text: Is any air condition equipment used in your home?<a href="c05-descriptive-analysis.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>Question text: What is the square footage of your home?<a href="c05-descriptive-analysis.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>BTUEL is derived from the supplier side component of the survey where BTUEL represents the electricity consumption in British thermal units (Btus) converted from kilowatt hours (kWh) in a year<a href="c05-descriptive-analysis.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>Question: How often can you trust the federal government in Washington to do what is right? (Always, most of the time, about half the time, some of the time, or never / Never, some of the time, about half the time, most of the time, or always)?<a href="c05-descriptive-analysis.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Question: Generally speaking, how often can you trust other people? (Always, most of the time, about half the time, some of the time, or never / Never, some of the time, about half the time, most of the time, or always)? <a href="c05-descriptive-analysis.html#fnref19" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="c04-understanding-survey-data-documentation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="c06-statistical-testing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/05-descriptive-analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
