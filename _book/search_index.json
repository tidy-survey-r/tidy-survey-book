[["index.html", "Tidy Survey Book Preface Why read this book Structure of the book Software information and conventions Acknowledgments", " Tidy Survey Book Stephanie Zimmer, Rebecca Powell, and Isabella Velásquez 2022-06-21 Preface Hi there, this is my great book. Why read this book It is very important Structure of the book Chapters ?? introduces a new topic, and  Software information and conventions I used the knitr package (Xie 2015) and the bookdown package (Xie 2022) to compile my book. My R session information is shown below: xfun::session_info() ## R version 4.1.3 (2022-03-10) ## Platform: x86_64-w64-mingw32/x64 (64-bit) ## Running under: Windows 10 x64 (build 19042) ## ## Locale: ## LC_COLLATE=English_United States.1252 ## LC_CTYPE=English_United States.1252 ## LC_MONETARY=English_United States.1252 ## LC_NUMERIC=C ## LC_TIME=English_United States.1252 ## ## Package version: ## base64enc_0.1.3 bookdown_0.26 bslib_0.3.1 ## cli_3.3.0 compiler_4.1.3 digest_0.6.29 ## evaluate_0.15 fastmap_1.1.0 fs_1.5.2 ## glue_1.6.2 graphics_4.1.3 grDevices_4.1.3 ## highr_0.9 htmltools_0.5.2 jquerylib_0.1.4 ## jsonlite_1.8.0 knitr_1.39 magrittr_2.0.3 ## methods_4.1.3 R6_2.5.1 rappdirs_0.3.3 ## renv_0.15.4 rlang_1.0.2 rmarkdown_2.14 ## rstudioapi_0.13 sass_0.4.1 stats_4.1.3 ## stringi_1.7.6 stringr_1.4.0 tinytex_0.39 ## tools_4.1.3 utils_4.1.3 xfun_0.31 ## yaml_2.3.5 Package names are in bold text (e.g., rmarkdown), and inline code and filenames are formatted in a typewriter font (e.g., knitr::knit('foo.Rmd')). Function names are followed by parentheses (e.g., bookdown::render_book()). Acknowledgments A lot of people helped me when I was writing the book. Frida Gomam on the Mars References "],["c01.html", "Chapter 1 Introduction", " Chapter 1 Introduction "],["c02.html", "Chapter 2 Introducing survey data", " Chapter 2 Introducing survey data "],["c03.html", "Chapter 3 Understanding survey data files", " Chapter 3 Understanding survey data files "],["c04.html", "Chapter 4 Introducing the srvyr package", " Chapter 4 Introducing the srvyr package "],["c05.html", "Chapter 5 Specifying sample designs in srvyr 5.1 Simple random sample without replacement 5.2 Simple random sample with replacement 5.3 Stratified sampling 5.4 Clustered sampling 5.5 Understanding survey design documentation", " Chapter 5 Specifying sample designs in srvyr The primary reason for using packages like {survey} and {srvyr} are to incorporate the sampling design into estimates. By incorporating the sampling design, precision estimates (e.g. standard errors and confidence intervals) are appropriately calculated. In this chapter, we will introduce common sampling designs, the mathematical methods for calculating estimates and standard errors for a given sampling design, and the R syntax to specify the sampling design. While we will show the math behind the estimates, the functions in these packages will do the calculation. 5.1 Simple random sample without replacement The simple random sample (SRS) without replacement is a sampling design where a fixed sample size \\((n)\\) is selected from a sampling frame of size \\((N)\\), and every possible subsample has equal probability of selection. A sampling frame is a list of the units from which a sample is selected. This is like sampling items out of a hat without replacing them back in the hat. While SRS is one of the simplest designs, it is not often implemented in large studies. To select a SRS, a list of all the units in the population must be available which is not always feasible. Additionally, the sample is drawn randomly without regard for the structure of the population which may not be practical for data collection so other designs are implemented as will be discussed later though SRS may still be a component of a stage of these designs. When analyzing survey data, some of the most common estimates desired are means, proportions, and their standard errors so we will introduce the formula for each of these under each design. Note that the package will implement these, but it is useful to understand. 5.1.1 The math The estimate for the population mean of variable \\(y\\) is: \\[\\bar{y}=\\frac{1}{n}\\sum_{i=1}^n y_i\\] and the estimate of the standard deviation of mean is: \\[se(\\bar{y})=\\sqrt{\\frac{s^2}{n}\\left( 1-\\frac{n}{N} \\right)}\\] and \\[s^2=\\frac{1}{n-1}\\sum_{i=1}^n\\left(y_i-\\bar{y}\\right)^2.\\] This standard error estimate might look very similar to equations in other applications seen except for the bit on the right side of the equation \\(1-\\frac{n}{N}\\) - this is call the finite population correction factor (FPC). If the size of the frame, \\(N\\), is very large, the FPC is negligible so it is often ignored. To estimate proportions, we define \\(x_i\\) as the indicator that the outcome is observed. That is, \\(x_i=1\\) if the outcome is observed and \\(x_i=0\\) if the outcome is not observed. Then the estimated proportion from a SRS design is: \\[\\hat{p}=\\frac{1}{n}\\sum_{i=1}^n x_i \\] and the estimated standard deviation of the proportion is: \\[se(\\hat{p})=\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n-1}\\left(1-\\frac{n}{N}\\right)} \\] 5.1.2 The syntax If a sample that was drawn through SRS and had no nonresponse or other weighting adjustments, in R specify this design as: des_srs1 &lt;- dat %&gt;% as_survey_design(fpc = fpcvar) where dat is a tibble or data.frame with the survey data and fpcvar is a variable on the tibble which indicates the size of the sampling frame. If the frame was very large, sometimes the frame size is not provided. In that case, specify the design as: des_srs2 &lt;- dat %&gt;% as_survey_design() If some post-survey adjustments were implemented and the weights are not all equal, specify the design as: des_srs3 &lt;- dat %&gt;% as_survey_design(weights = wtvar, fpc = fpcvar) where wtvar is the variable for the weight on the data. Again, the fpc can be omitted if it is not necessary because the frame is large. 5.1.3 An example The {survey} package in R provides some example datasets to use and those will be used throughout this chapter. The Academic Performance Index (API) was a program administered by the California Department of Education. These datasets are derived from that data and include a population file (frame) of all schools with at least 100 students and several samples from that data. A SRS of 200 schools was sampled and included in apisrs. The SRS sample data is illustrated below: options(tidyverse.quiet = TRUE) library(tidyverse) library(survey) ## Loading required package: grid ## Loading required package: Matrix ## ## Attaching package: &#39;Matrix&#39; ## The following objects are masked from &#39;package:tidyr&#39;: ## ## expand, pack, unpack ## Loading required package: survival ## ## Attaching package: &#39;survey&#39; ## The following object is masked from &#39;package:graphics&#39;: ## ## dotchart library(srvyr) ## ## Attaching package: &#39;srvyr&#39; ## The following object is masked from &#39;package:stats&#39;: ## ## filter data(api) apisrs_slim &lt;- apisrs %&gt;% as_tibble() %&gt;% arrange(dnum, snum) %&gt;% select(cds, dnum, snum, dname, sname, fpc, pw) School districts have identifiers dnum and schools have identifiers of snum along with their names. Additionally, the fpc is included as fpc and the weight as pw. This design should be specified as: des_apisrs &lt;- apisrs_slim %&gt;% as_survey_design(weights = pw, fpc = fpc) des_apisrs ## Independent Sampling design ## Called via srvyr ## Sampling variables: ## - ids: `1` ## - fpc: fpc ## - weights: pw ## Data variables: cds (chr), dnum (int), snum (dbl), ## dname (chr), sname (chr), fpc (dbl), pw (dbl) summary(des_apisrs) ## Independent Sampling design ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.0323 0.0323 0.0323 0.0323 0.0323 0.0323 ## Population size (PSUs): 6194 ## Data variables: ## [1] &quot;cds&quot; &quot;dnum&quot; &quot;snum&quot; &quot;dname&quot; &quot;sname&quot; &quot;fpc&quot; ## [7] &quot;pw&quot; Printing the design object above, the design is described as an Independent Sampling design which is another terminology for SRS. The ids are specified as 1 which means there is no clustering (a topic described later in this chapter), the fpc variable is indicated, and the weights are indicated. When looking at the summary of the design object, the population size is given a summary of the probabilities (inverse of the weights). 5.2 Simple random sample with replacement The simple random sample (SRSWR) with replacement is a sampling design where a fixed sample size \\((n)\\) is selected from a sampling frame of size \\((N)\\) and units can be selected more than once. This is like sampling items out of a hat and replacing them back in the hat before selecting another item. Similar to a SRS design, a full list of the population must be available. As a reminder, units can be selected more than once so would appear in the data frame more than once and thus appear in the sums more than once. 5.2.1 The math The estimate for the population mean of variable \\(y\\) is: \\[\\bar{y}=\\frac{1}{n}\\sum_{i=1}^n y_i\\] and the estimate of the standard deviation of mean is: \\[\\sqrt{\\frac{s^2}{n}}\\] and \\[s^2=\\frac{1}{n-1}\\sum_{i=1}^n\\left(y_i-\\bar{y}\\right)^2.\\] Again, we define \\(x_i\\) as the indicator that the outcome is observed. Then the estimated proportion from a SRSWR design is: \\[\\hat{p}=\\frac{1}{n}\\sum_{i=1}^n x_i \\] and the estimated standard deviation of the proportion is: \\[se(\\hat{p})=\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} \\] 5.2.2 The syntax If you had a sample that was drawn through SRSWR and had no nonresponse or other weighting adjustments, in R, you should specify this design as: des_srswr1 &lt;- dat %&gt;% as_survey_design() where dat is a tibble or data.frame with your survey data. If some post-survey adjustments were implemented and the weights are not all equal, specify the design as: des_srswr2 &lt;- dat %&gt;% as_survey_design(weights = wtvar) where wtvar is the variable for the weight on the data. The {survey} package does not include an example of SRSWR so we create an example below. Note that this is sampled with replacements so there are duplicates. These duplicates are listed more than once and for proper estimation are deduplicated. set.seed(409963) apisrswr &lt;- apipop %&gt;% as_tibble() %&gt;% slice_sample(n = 200, replace = TRUE) %&gt;% select(cds, dnum, snum, dname, sname) %&gt;% mutate( weight = nrow(apipop)/200 ) head(apisrswr) ## # A tibble: 6 x 6 ## cds dnum snum dname sname weight ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 43696416060065 533 5348 Palo Alto Un~ Jord~ 31.0 ## 2 07618046005060 650 509 San Ramon Va~ Alam~ 31.0 ## 3 19648086085674 457 2134 Montebello U~ La M~ 31.0 ## 4 07617056003719 346 377 Knightsen El~ Knig~ 31.0 ## 5 19650606023022 744 2351 Torrance Uni~ Carr~ 31.0 ## 6 01611196090120 6 13 Alameda City~ Pade~ 31.0 apisrswr %&gt;% filter(duplicated(cds) | duplicated(cds, fromLast=TRUE)) ## # A tibble: 4 x 6 ## cds dnum snum dname sname weight ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 39686766042782 716 4880 Stockton Cit~ Tyle~ 31.0 ## 2 15633216008841 41 869 Bakersfield ~ Chip~ 31.0 ## 3 39686766042782 716 4880 Stockton Cit~ Tyle~ 31.0 ## 4 15633216008841 41 869 Bakersfield ~ Chip~ 31.0 A weight variable was added which is the inverse of the probability of selection. To specify the sampling design for apisrswr, the following syntax should be used: des_apisrswr &lt;- apisrswr %&gt;% as_survey_design(weights = weight) des_apisrswr ## Independent Sampling design (with replacement) ## Called via srvyr ## Sampling variables: ## - ids: `1` ## - weights: weight ## Data variables: cds (chr), dnum (int), snum (dbl), ## dname (chr), sname (chr), weight (dbl) summary(des_apisrswr) ## Independent Sampling design (with replacement) ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.0323 0.0323 0.0323 0.0323 0.0323 0.0323 ## Data variables: ## [1] &quot;cds&quot; &quot;dnum&quot; &quot;snum&quot; &quot;dname&quot; &quot;sname&quot; ## [6] &quot;weight&quot; When printing the design object or showing its summary, it is noted that the sampling is done with replacement because no fpc was specified unlike the SRS without replacement example. 5.3 Stratified sampling In stratified sampling, the population is divided into mutually exclusive subpopulations called strata and then samples are selected within each of the strata. Stratification is done for two primary reasons: Ensuring sample representation from all the subpopulations. A SRS cannot guarantee that your sample will include all subpopulations that you may desire in your sample so this type of design ensures representation of all planned subpopulations. For example, if we are doing a survey of professors at a university, we might want to stratify by college to ensure we get professors in the sample from all colleges. Stratification can be used for statistical efficiency. If the outcome is correlated with the subpopulations then the variance of the estimate will be lower when implementing stratification. Within each strata, sampling can be done in any manner but we will consider the case of SRS selection within each strata. Commonly, strata are numbered as \\(1, \\ldots, H\\). 5.3.1 The math Let \\(\\bar{y}_h\\) be the sample mean for stratum \\(h\\), \\(N_h\\) be the population size of stratum \\(h\\), and \\(n_h\\) be the sample size of stratum \\(h\\). Then the estimate for the population mean under stratified SRS sampling is: \\[\\bar{y}=\\frac{1}{N}\\sum_{h=1}^H N_h\\bar{y}_h\\] and the estimate of the standard error of \\(\\bar{y}\\) is: \\[\\sqrt{\\frac{1}{N^2} \\sum_{h=1}^H N_h^2 s_h^2\\left(1-\\frac{n_h}{N_h}\\right)} \\] where \\[s_h^2=\\frac{1}{n_h-1}\\sum_{i=1}^{n_h}\\left(y_{i,h}-\\bar{y}_h\\right)^2.\\] For estimates of proportions, let \\(\\hat{p}_h\\) be the estimated proportion in stratum \\(h\\). Then the population proportion estimate is: \\[\\hat{p}= \\frac{1}{N}\\sum_{h=1}^H N_h \\hat{p}_h\\] and the standard error of the proportion is: \\[se(\\hat{p}) = \\frac{1}{N} \\sqrt{ \\sum_{h=1}^H N_h^2 \\frac{\\hat{p}_h(1-\\hat{p}_h)}{n_h-1} \\left(1-\\frac{n_h}{N_h}\\right)}\\] 5.3.2 The syntax To specify a stratified SRS design in {srvyr} where the population sizes of the strata are not too large and are known, that is you are using the fpc, specify the design as: des_stsrs1 &lt;- dat %&gt;% as_survey_design(fpc = fpcvar, strata = stratvar) where fpcvar is a variable on your data which indicates \\(N_h\\) for each row and stratavar is a variable indicating the stratum for each row. You can omit the fpc if it is not applicable. Additionally, you can indicate the weight variable if it is present where wtvar is a variable on your data with a numeric weight. des_stsrs2 &lt;- dat %&gt;% as_survey_design(weights = wtvar, strata = stratvar) 5.3.3 An example In the example API data, apistrat is a stratified random sample, stratified by school type (stype). The data is illustrated below: apistrat_slim &lt;- apistrat %&gt;% as_tibble() %&gt;% arrange(dnum, snum) %&gt;% select(cds, dnum, snum, dname, sname, stype, fpc, pw) apistrat_slim %&gt;% count(stype, fpc) ## # A tibble: 3 x 3 ## stype fpc n ## &lt;fct&gt; &lt;dbl&gt; &lt;int&gt; ## 1 E 4421 100 ## 2 H 755 50 ## 3 M 1018 50 The fpc is the same within each stratum and 100 elementary schools were sampled while 50 schools were sampled from both the middle and high school levels. This design should be specified as: des_apistrat &lt;- apistrat_slim %&gt;% as_survey_design(strata = stype, weights = pw, fpc = fpc) des_apistrat ## Stratified Independent Sampling design ## Called via srvyr ## Sampling variables: ## - ids: `1` ## - strata: stype ## - fpc: fpc ## - weights: pw ## Data variables: cds (chr), dnum (int), snum (dbl), ## dname (chr), sname (chr), stype (fct), fpc (dbl), pw ## (dbl) summary(des_apistrat) ## Stratified Independent Sampling design ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.0226 0.0226 0.0359 0.0401 0.0534 0.0662 ## Stratum Sizes: ## E H M ## obs 100 50 50 ## design.PSU 100 50 50 ## actual.PSU 100 50 50 ## Population stratum sizes (PSUs): ## E H M ## 4421 755 1018 ## Data variables: ## [1] &quot;cds&quot; &quot;dnum&quot; &quot;snum&quot; &quot;dname&quot; &quot;sname&quot; &quot;stype&quot; ## [7] &quot;fpc&quot; &quot;pw&quot; When printing the object, it is specified as a Stratified Independent Sampling design also known as a stratified SRS and the strata variable is included. In the summary, a numeric summary of the probabilities of selection are displayed as well as the sample and population stratum sizes. 5.4 Clustered sampling There are several forms of cluster sampling. In clustered sampling, a population is divided into mutually exclusive subgroups called clusters or primary sampling units (PSUs). These PSUs are randomly sampled and then sampling is done within these clusters. There can be multiple levels of this selection. Clustered sampling is often used when a list of the entire population is not available or data collection involves interviewers needing direct contact with respondents. For example, consider a study needing a sample of 6th grade students in the United States, no list likely exists of all these students. Obtaining a list of schools that have 6th graders is more likely to be possible so a study design could select a random sample of schools that have 6th graders. The selected schools can then provide a list of students to do a second stage of sampling where 6th grade students are randomly sampled within each of the sampled schools. This is a one-stage sample design and will be the type of design we will discuss in formulas below. A more complicated but realistic example is necessary when sending out interviewers to households for a survey. Counties could be selected as the PSU, then Census block groups within counties selected as the secondary sampling unit (SSU), and then households within the block groups. This type of design reduces the travel necessary for interviewers. Clustered designs are used as a practical solution but are not statistically efficient and should be avoided if they are not necessary. In the household survey example, this process would not be necessary if surveys were mailed to homes but interviewers were never sent out in person. 5.4.1 The math Consider a population where the are \\(N\\) clusters and \\(n\\) clusters are sampled via SRSWOR. Units within the sampled cluster are sampled via SRSWOR as well. Let \\(M_i\\) be the number of units in cluster \\(i\\) and \\(\\bar{y}_i\\) be the sample mean of cluster \\(i\\). Then, a ratio estimator of the population mean is: \\[\\bar{y}=\\frac{\\sum_{i=1}^n M_i \\bar{y}_i}{ \\sum_{i=1}^n M_i}\\] Note this is a consistent but biased estimator. Often the population size is not known so this is a method to estimate a mean without knowing the population size. The estimated standard error of the mean is: \\[se(\\bar{y})=\\frac{1}{\\hat{N}_{pop} } \\sqrt{\\frac{N^2 (1-\\frac{n}{N})}{n}\\frac{1}{n-1} \\sum_{i=1}^n (M_i\\bar{y}_i -\\hat{t}/N)^2 + \\frac{N}{n} \\sum_{i=1}^n \\frac{M_i^2}{m_i}\\left(1-\\frac{m_i}{M_i}\\right)s^2_i }\\] where \\(\\hat{N}_{pop}\\) is the estimated population size, \\(\\hat{t}\\) is the estimated total, and \\(s_i^2\\) is the sample variance of cluster \\(i\\). For estimates of proportions, the estimated proportion is: \\[\\hat{p}=\\frac{\\sum_{i=1}^n M_i \\hat{p}_i}{ \\sum_{i=1}^n M_i}\\] and the associated standard error estimate is: \\[se(\\hat{p})=\\frac{1}{\\hat{N}_{pop} } \\sqrt{\\frac{N^2 (1-\\frac{n}{N})}{n}\\frac{1}{n-1} \\sum_{i=1}^n (M_i\\hat{p}_i -\\hat{t}/N)^2 + \\frac{N}{n} \\sum_{i=1}^n \\frac{M_i^2}{m_i}\\left(1-\\frac{m_i}{M_i}\\right)s^2_i }\\] where \\(s^2_i\\) is defined as: \\[s^2_i = \\frac{m_hp_h(1-p_h)}{m_h-1}\\]. 5.4.2 The syntax To specify a two-stage clustered design without replacement, use the following syntax: des_clus2 &lt;- dat %&gt;% as_survey_design(weights = wtvar, ids = c(PSU, SSU), fpc = c(N, M)) where SSU and PSU are the variables indicating the PSU and SSU identifiers and N and M are the variables indicating the population sizes - the number of clusters and then the number of units within each cluster. Note that N will be the same for all records (within a strata) and M will be the same for all records within the same cluster. If clusters were sampled with replacement or from a very large population, a fpc is not necessary. Additionally, only the first stage of selection is necessary. The syntax below will yield the same estimates in the end: des_clus2wra &lt;- dat %&gt;% as_survey_design(weights = wtvar, ids = c(PSU, SSU)) des_clus2wrb &lt;- dat %&gt;% as_survey_design(weights = wtvar, ids = PSU) 5.4.3 An example The survey package includes a two-stage cluster sample data, apiclus2, in which school districts were sampled and then a random sample of 5 schools was selected within each district. For districts with fewer than 5 schools, all schools were sampled. School districts have identifiers dnum and schools have identifiers of snum. The variable fpc1 indicates how many districts there were in California and fpc2 indicates how many schools were in a given district with at least 100 students. The data has a row for each school. In the data printed below, there are 757 school districts as indicated by fpc1 and there are 9 schools in district 731, one school in district 742, 2 schools in district 768, 6 schools in district 781, and 1 school in district 795 as indicated by fpc2. apiclus2_slim &lt;- apiclus2 %&gt;% as_tibble() %&gt;% arrange(desc(dnum), snum) %&gt;% select(cds, dnum, snum, fpc1, fpc2, pw) apiclus2_slim ## # A tibble: 126 x 6 ## cds dnum snum fpc1 fpc2 pw ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; ## 1 47704826050942 795 5552 757 1 18.9 ## 2 07618126005169 781 530 757 6 22.7 ## 3 07618126005177 781 531 757 6 22.7 ## 4 07618126005185 781 532 757 6 22.7 ## 5 07618126005193 781 533 757 6 22.7 ## 6 07618126005243 781 535 757 6 22.7 ## 7 19650786023337 768 2371 757 2 18.9 ## 8 19650786023345 768 2372 757 2 18.9 ## 9 54722076054423 742 5898 757 1 18.9 ## 10 50712906053086 731 5781 757 9 34.1 ## # ... with 116 more rows To specify this design in R, the following syntax should be used: des_apiclus2 &lt;- apiclus2_slim %&gt;% as_survey_design(ids = c(dnum, snum), fpc = c(fpc1, fpc2), weights=pw) des_apiclus2 ## 2 - level Cluster Sampling design ## With (40, 126) clusters. ## Called via srvyr ## Sampling variables: ## - ids: `dnum + snum` ## - fpc: `fpc1 + fpc2` ## - weights: pw ## Data variables: cds (chr), dnum (int), snum (dbl), ## fpc1 (dbl), fpc2 (int), pw (dbl) summary(des_apiclus2) ## 2 - level Cluster Sampling design ## With (40, 126) clusters. ## Called via srvyr ## Probabilities: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.00367 0.03774 0.05284 0.04239 0.05284 0.05284 ## Population size (PSUs): 757 ## Data variables: ## [1] &quot;cds&quot; &quot;dnum&quot; &quot;snum&quot; &quot;fpc1&quot; &quot;fpc2&quot; &quot;pw&quot; The design objects are described as 2 - level Cluster Sampling design and includes the ids (cluster), fpc, and weight variables. In the summary, it is noted that the sample includes 40 first-level clusters (PSUs) which are school districts and 126 second-level clusters (SSUs) which are schools. Additionally, the summary includes a numeric summary of the probabilities and the population size (number of PSUs) as 757. 5.5 Understanding survey design documentation SRS, stratified, and clustered designs are the backbone of sampling designs and the features are often combined in one design. Additionally, rather than using SRS for selection, other mechanisms are commonly used such as probability proportional to size (PPS), systematic sampling, or selection with unequal probabilities. A common method of sampling is to stratify PSUs, select PSUs within stratum using PPS selection, and then select units within the PSUs either with SRS or PPS. Reading survey documentation is an important first step of survey analysis to understand the design and variables necessary to specify the design. Good documentation will highlight the variables necessary to specify the design. This is often found in Users Guides, methodology, analysis guides, or technical documentation. For example, the 2017-2019 National Survey of Family Growth (NSFG)1 had a stratified multi-stage area probability sample. Counties or collections of counties were the primary sampling units which were stratified by Census region/division, size (population), and MSA status. Within each stratum, PSUs were selected PPS. At the second stage, neighborhoods were selected within the sampled PSUs using PPS selection. At the third stage, housing units were selected within the sampled neighborhoods. At the fourth stage, a person was randomly chosen within the selected housing units among eligible persons using unequal probabilities based on persons age and sex. The public use file does not include all these levels of selection and instead includes pseudo-strata and pseudo-clusters2 which are the variables used in R to specify the design. As specified on page 4, the stratum variable is SEST, the cluster variable is SECU, and the weight variable is WGT2017_2019. Thus, to specify this design in R, one would use the following syntax: des_nsfg &lt;- nsfgdata %&gt;% as_survey_design(ids = SECU, strata = SEST, weights = WGT2017_2019) 2017-2019 National Survey of Family Growth (NSFG): Sample Design Documentation - https://www.cdc.gov/nchs/data/nsfg/NSFG-2017-2019-Sample-Design-Documentation-508.pdf 2017-2019 National Survey of Family Growth (NSFG): Sample Error Estimation Design - https://www.cdc.gov/nchs/data/nsfg/NSFG-2017-2019-Sample-Error-Estimation-Design-508.pdf "],["c06.html", "Chapter 6 Descriptive analyses in srvyr", " Chapter 6 Descriptive analyses in srvyr "],["c07.html", "Chapter 7 Statistical testing", " Chapter 7 Statistical testing "],["c08.html", "Chapter 8 Modeling", " Chapter 8 Modeling "],["c09.html", "Chapter 9 Presenting results", " Chapter 9 Presenting results "],["more-to-say.html", "A More to Say", " A More to Say Yeah! I have finished my book, but I have more to say about some topics. Let me explain them in this appendix. To know more about bookdown, see https://bookdown.org. "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
